!function(){"use strict";class t extends Error{constructor(t,e){const n=new.target.prototype;super(`${t}: Status code '${e}'`),this.statusCode=e,this.__proto__=n}}class e extends Error{constructor(t="A timeout occurred."){const e=new.target.prototype;super(t),this.__proto__=e}}class n extends Error{constructor(t="An abort occurred."){const e=new.target.prototype;super(t),this.__proto__=e}}class r extends Error{constructor(t,e){const n=new.target.prototype;super(t),this.transport=e,this.errorType="UnsupportedTransportError",this.__proto__=n}}class o extends Error{constructor(t,e){const n=new.target.prototype;super(t),this.transport=e,this.errorType="DisabledTransportError",this.__proto__=n}}class i extends Error{constructor(t,e){const n=new.target.prototype;super(t),this.transport=e,this.errorType="FailedToStartTransportError",this.__proto__=n}}class s extends Error{constructor(t){const e=new.target.prototype;super(t),this.errorType="FailedToNegotiateWithServerError",this.__proto__=e}}class a extends Error{constructor(t,e){const n=new.target.prototype;super(t),this.innerErrors=e,this.__proto__=n}}class c{constructor(t,e,n){this.statusCode=t,this.statusText=e,this.content=n}}class u{get(t,e){return this.send({...e,method:"GET",url:t})}post(t,e){return this.send({...e,method:"POST",url:t})}delete(t,e){return this.send({...e,method:"DELETE",url:t})}getCookieString(t){return""}}var l;!function(t){t[t.Trace=0]="Trace",t[t.Debug=1]="Debug",t[t.Information=2]="Information",t[t.Warning=3]="Warning",t[t.Error=4]="Error",t[t.Critical=5]="Critical",t[t.None=6]="None"}(l||(l={}));class p{constructor(){}log(t,e){}}p.instance=new p;const h="6.0.7";class _{static isRequired(t,e){if(null==t)throw new Error(`The '${e}' argument is required.`)}static isNotEmpty(t,e){if(!t||t.match(/^\s*$/))throw new Error(`The '${e}' argument should not be empty.`)}static isIn(t,e,n){if(!(t in e))throw new Error(`Unknown ${n} value: ${t}.`)}}class f{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&void 0===window.document}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function d(t,e){let n="";return E(t)?(n=`Binary data of length ${t.byteLength}`,e&&(n+=`. Content: '${function(t){const e=new Uint8Array(t);let n="";return e.forEach((t=>{n+=`0x${t<16?"0":""}${t.toString(16)} `})),n.substr(0,n.length-1)}(t)}'`)):"string"==typeof t&&(n=`String data of length ${t.length}`,e&&(n+=`. Content: '${t}'`)),n}function E(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}async function g(t,e,n,r,o,i,s){let a={};if(o){const t=await o();t&&(a={Authorization:`Bearer ${t}`})}const[c,u]=S();a[c]=u,t.log(l.Trace,`(${e} transport) sending data. ${d(i,s.logMessageContent)}.`);const p=E(i)?"arraybuffer":"text",h=await n.post(r,{content:i,headers:{...a,...s.headers},responseType:p,timeout:s.timeout,withCredentials:s.withCredentials});t.log(l.Trace,`(${e} transport) request complete. Response status: ${h.statusCode}.`)}class y{constructor(t,e){this._subject=t,this._observer=e}dispose(){const t=this._subject.observers.indexOf(this._observer);t>-1&&this._subject.observers.splice(t,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch((t=>{}))}}class m{constructor(t){this._minLevel=t,this.out=console}log(t,e){if(t>=this._minLevel){const n=`[${(new Date).toISOString()}] ${l[t]}: ${e}`;switch(t){case l.Critical:case l.Error:this.out.error(n);break;case l.Warning:this.out.warn(n);break;case l.Information:this.out.info(n);break;default:this.out.log(n)}}}}function S(){let t="X-SignalR-User-Agent";return f.isNode&&(t="User-Agent"),[t,v(h,T(),O(),b())]}function v(t,e,n,r){let o="Microsoft SignalR/";const i=t.split(".");return o+=`${i[0]}.${i[1]}`,o+=` (${t}; `,o+=e&&""!==e?`${e}; `:"Unknown OS; ",o+=`${n}`,o+=r?`; ${r}`:"; Unknown Runtime Version",o+=")",o}function T(){if(!f.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function b(){if(f.isNode)return process.versions.node}function O(){return f.isNode?"NodeJS":"Browser"}function w(t){return t.stack?t.stack:t.message?t.message:`${t}`}class A extends u{constructor(t){if(super(),this._logger=t,"undefined"==typeof fetch){const t="function"==typeof __webpack_require__?__non_webpack_require__:require;this._jar=new(t("tough-cookie").CookieJar),this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("could not find global")}());if("undefined"==typeof AbortController){const t="function"==typeof __webpack_require__?__non_webpack_require__:require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}async send(r){if(r.abortSignal&&r.abortSignal.aborted)throw new n;if(!r.method)throw new Error("No method defined.");if(!r.url)throw new Error("No url defined.");const o=new this._abortControllerType;let i;r.abortSignal&&(r.abortSignal.onabort=()=>{o.abort(),i=new n});let s,a=null;if(r.timeout){const t=r.timeout;a=setTimeout((()=>{o.abort(),this._logger.log(l.Warning,"Timeout from HTTP request."),i=new e}),t)}try{s=await this._fetchType(r.url,{body:r.content,cache:"no-cache",credentials:!0===r.withCredentials?"include":"same-origin",headers:{"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest",...r.headers},method:r.method,mode:"cors",redirect:"follow",signal:o.signal})}catch(t){if(i)throw i;throw this._logger.log(l.Warning,`Error from HTTP request. ${t}.`),t}finally{a&&clearTimeout(a),r.abortSignal&&(r.abortSignal.onabort=null)}if(!s.ok){const e=await C(s,"text");throw new t(e||s.statusText,s.status)}const u=C(s,r.responseType),p=await u;return new c(s.status,s.statusText,p)}getCookieString(t){let e="";return f.isNode&&this._jar&&this._jar.getCookies(t,((t,n)=>e=n.join("; "))),e}}function C(t,e){let n;switch(e){case"arraybuffer":n=t.arrayBuffer();break;case"text":default:n=t.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`)}return n}class R extends u{constructor(t){super(),this._logger=t}send(r){return r.abortSignal&&r.abortSignal.aborted?Promise.reject(new n):r.method?r.url?new Promise(((o,i)=>{const s=new XMLHttpRequest;s.open(r.method,r.url,!0),s.withCredentials=void 0===r.withCredentials||r.withCredentials,s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-Type","text/plain;charset=UTF-8");const a=r.headers;a&&Object.keys(a).forEach((t=>{s.setRequestHeader(t,a[t])})),r.responseType&&(s.responseType=r.responseType),r.abortSignal&&(r.abortSignal.onabort=()=>{s.abort(),i(new n)}),r.timeout&&(s.timeout=r.timeout),s.onload=()=>{r.abortSignal&&(r.abortSignal.onabort=null),s.status>=200&&s.status<300?o(new c(s.status,s.statusText,s.response||s.responseText)):i(new t(s.response||s.responseText||s.statusText,s.status))},s.onerror=()=>{this._logger.log(l.Warning,`Error from HTTP request. ${s.status}: ${s.statusText}.`),i(new t(s.statusText,s.status))},s.ontimeout=()=>{this._logger.log(l.Warning,"Timeout from HTTP request."),i(new e)},s.send(r.content||"")})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class N extends u{constructor(t){if(super(),"undefined"!=typeof fetch||f.isNode)this._httpClient=new A(t);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new R(t)}}send(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new n):t.method?t.url?this._httpClient.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(t){return this._httpClient.getCookieString(t)}}class I{static write(t){return`${t}${I.RecordSeparator}`}static parse(t){if(t[t.length-1]!==I.RecordSeparator)throw new Error("Message is incomplete.");const e=t.split(I.RecordSeparator);return e.pop(),e}}I.RecordSeparatorCode=30,I.RecordSeparator=String.fromCharCode(I.RecordSeparatorCode);class P{writeHandshakeRequest(t){return I.write(JSON.stringify(t))}parseHandshakeResponse(t){let e,n;if(E(t)){const r=new Uint8Array(t),o=r.indexOf(I.RecordSeparatorCode);if(-1===o)throw new Error("Message is incomplete.");const i=o+1;e=String.fromCharCode.apply(null,Array.prototype.slice.call(r.slice(0,i))),n=r.byteLength>i?r.slice(i).buffer:null}else{const r=t,o=r.indexOf(I.RecordSeparator);if(-1===o)throw new Error("Message is incomplete.");const i=o+1;e=r.substring(0,i),n=r.length>i?r.substring(i):null}const r=I.parse(e),o=JSON.parse(r[0]);if(o.type)throw new Error("Expected a handshake response from the server.");return[n,o]}}var M;!function(t){t[t.Invocation=1]="Invocation",t[t.StreamItem=2]="StreamItem",t[t.Completion=3]="Completion",t[t.StreamInvocation=4]="StreamInvocation",t[t.CancelInvocation=5]="CancelInvocation",t[t.Ping=6]="Ping",t[t.Close=7]="Close"}(M||(M={}));class L{constructor(){this.observers=[]}next(t){for(const e of this.observers)e.next(t)}error(t){for(const e of this.observers)e.error&&e.error(t)}complete(){for(const t of this.observers)t.complete&&t.complete()}subscribe(t){return this.observers.push(t),new y(this,t)}}var D;!function(t){t.Disconnected="Disconnected",t.Connecting="Connecting",t.Connected="Connected",t.Disconnecting="Disconnecting",t.Reconnecting="Reconnecting"}(D||(D={}));class x{constructor(t,e,n,r){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(l.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},_.isRequired(t,"connection"),_.isRequired(e,"logger"),_.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this._logger=e,this._protocol=n,this.connection=t,this._reconnectPolicy=r,this._handshakeProtocol=new P,this.connection.onreceive=t=>this._processIncomingData(t),this.connection.onclose=t=>this._connectionClosed(t),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=D.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:M.Ping})}static create(t,e,n,r){return new x(t,e,n,r)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(t){if(this._connectionState!==D.Disconnected&&this._connectionState!==D.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!t)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=t}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==D.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=D.Connecting,this._logger.log(l.Debug,"Starting HubConnection.");try{await this._startInternal(),f.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=D.Connected,this._connectionStarted=!0,this._logger.log(l.Debug,"HubConnection connected successfully.")}catch(t){return this._connectionState=D.Disconnected,this._logger.log(l.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const t=new Promise(((t,e)=>{this._handshakeResolver=t,this._handshakeRejecter=e}));await this.connection.start(this._protocol.transferFormat);try{const e={protocol:this._protocol.name,version:this._protocol.version};if(this._logger.log(l.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(e)),this._logger.log(l.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await t,this._stopDuringStartError)throw this._stopDuringStartError}catch(t){throw this._logger.log(l.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(t),t}}async stop(){const t=this._startPromise;this._stopPromise=this._stopInternal(),await this._stopPromise;try{await t}catch(t){}}_stopInternal(t){return this._connectionState===D.Disconnected?(this._logger.log(l.Debug,`Call to HubConnection.stop(${t}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===D.Disconnecting?(this._logger.log(l.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=D.Disconnecting,this._logger.log(l.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(l.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=t||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(t)))}stream(t,...e){const[n,r]=this._replaceStreamingParams(e),o=this._createStreamInvocation(t,e,r);let i;const s=new L;return s.cancelCallback=()=>{const t=this._createCancelInvocation(o.invocationId);return delete this._callbacks[o.invocationId],i.then((()=>this._sendWithProtocol(t)))},this._callbacks[o.invocationId]=(t,e)=>{e?s.error(e):t&&(t.type===M.Completion?t.error?s.error(new Error(t.error)):s.complete():s.next(t.item))},i=this._sendWithProtocol(o).catch((t=>{s.error(t),delete this._callbacks[o.invocationId]})),this._launchStreams(n,i),s}_sendMessage(t){return this._resetKeepAliveInterval(),this.connection.send(t)}_sendWithProtocol(t){return this._sendMessage(this._protocol.writeMessage(t))}send(t,...e){const[n,r]=this._replaceStreamingParams(e),o=this._sendWithProtocol(this._createInvocation(t,e,!0,r));return this._launchStreams(n,o),o}invoke(t,...e){const[n,r]=this._replaceStreamingParams(e),o=this._createInvocation(t,e,!1,r);return new Promise(((t,e)=>{this._callbacks[o.invocationId]=(n,r)=>{r?e(r):n&&(n.type===M.Completion?n.error?e(new Error(n.error)):t(n.result):e(new Error(`Unexpected message type: ${n.type}`)))};const r=this._sendWithProtocol(o).catch((t=>{e(t),delete this._callbacks[o.invocationId]}));this._launchStreams(n,r)}))}on(t,e){t&&e&&(t=t.toLowerCase(),this._methods[t]||(this._methods[t]=[]),-1===this._methods[t].indexOf(e)&&this._methods[t].push(e))}off(t,e){if(!t)return;t=t.toLowerCase();const n=this._methods[t];if(n)if(e){const r=n.indexOf(e);-1!==r&&(n.splice(r,1),0===n.length&&delete this._methods[t])}else delete this._methods[t]}onclose(t){t&&this._closedCallbacks.push(t)}onreconnecting(t){t&&this._reconnectingCallbacks.push(t)}onreconnected(t){t&&this._reconnectedCallbacks.push(t)}_processIncomingData(t){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(t=this._processHandshakeResponse(t),this._receivedHandshakeResponse=!0),t){const e=this._protocol.parseMessages(t,this._logger);for(const t of e)switch(t.type){case M.Invocation:this._invokeClientMethod(t);break;case M.StreamItem:case M.Completion:{const e=this._callbacks[t.invocationId];if(e){t.type===M.Completion&&delete this._callbacks[t.invocationId];try{e(t)}catch(t){this._logger.log(l.Error,`Stream callback threw error: ${w(t)}`)}}break}case M.Ping:break;case M.Close:{this._logger.log(l.Information,"Close message received from server.");const e=t.error?new Error("Server returned an error on close: "+t.error):void 0;!0===t.allowReconnect?this.connection.stop(e):this._stopPromise=this._stopInternal(e);break}default:this._logger.log(l.Warning,`Invalid message type: ${t.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(t){let e,n;try{[n,e]=this._handshakeProtocol.parseHandshakeResponse(t)}catch(t){const e="Error parsing handshake response: "+t;this._logger.log(l.Error,e);const n=new Error(e);throw this._handshakeRejecter(n),n}if(e.error){const t="Server returned handshake error: "+e.error;this._logger.log(l.Error,t);const n=new Error(t);throw this._handshakeRejecter(n),n}return this._logger.log(l.Debug,"Server handshake complete."),this._handshakeResolver(),n}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let t=this._nextKeepAlive-(new Date).getTime();t<0&&(t=0),this._pingServerHandle=setTimeout((async()=>{if(this._connectionState===D.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}),t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(t){const e=this._methods[t.target.toLowerCase()];if(e){try{e.forEach((e=>e.apply(this,t.arguments)))}catch(e){this._logger.log(l.Error,`A callback for the method ${t.target.toLowerCase()} threw error '${e}'.`)}if(t.invocationId){const t="Server requested a response, which is not supported in this version of the client.";this._logger.log(l.Error,t),this._stopPromise=this._stopInternal(new Error(t))}}else this._logger.log(l.Warning,`No client method with the name '${t.target}' found.`)}_connectionClosed(t){this._logger.log(l.Debug,`HubConnection.connectionClosed(${t}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||t||new Error("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(t||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===D.Disconnecting?this._completeClose(t):this._connectionState===D.Connected&&this._reconnectPolicy?this._reconnect(t):this._connectionState===D.Connected&&this._completeClose(t)}_completeClose(t){if(this._connectionStarted){this._connectionState=D.Disconnected,this._connectionStarted=!1,f.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach((e=>e.apply(this,[t])))}catch(e){this._logger.log(l.Error,`An onclose callback called with error '${t}' threw error '${e}'.`)}}}async _reconnect(t){const e=Date.now();let n=0,r=void 0!==t?t:new Error("Attempting to reconnect due to a unknown error."),o=this._getNextRetryDelay(n++,0,r);if(null===o)return this._logger.log(l.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(t);if(this._connectionState=D.Reconnecting,t?this._logger.log(l.Information,`Connection reconnecting because of error '${t}'.`):this._logger.log(l.Information,"Connection reconnecting."),0!==this._reconnectingCallbacks.length){try{this._reconnectingCallbacks.forEach((e=>e.apply(this,[t])))}catch(e){this._logger.log(l.Error,`An onreconnecting callback called with error '${t}' threw error '${e}'.`)}if(this._connectionState!==D.Reconnecting)return void this._logger.log(l.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==o;){if(this._logger.log(l.Information,`Reconnect attempt number ${n} will start in ${o} ms.`),await new Promise((t=>{this._reconnectDelayHandle=setTimeout(t,o)})),this._reconnectDelayHandle=void 0,this._connectionState!==D.Reconnecting)return void this._logger.log(l.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=D.Connected,this._logger.log(l.Information,"HubConnection reconnected successfully."),0!==this._reconnectedCallbacks.length)try{this._reconnectedCallbacks.forEach((t=>t.apply(this,[this.connection.connectionId])))}catch(t){this._logger.log(l.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${t}'.`)}return}catch(t){if(this._logger.log(l.Information,`Reconnect attempt failed because of error '${t}'.`),this._connectionState!==D.Reconnecting)return this._logger.log(l.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===D.Disconnecting&&this._completeClose());r=t instanceof Error?t:new Error(t.toString()),o=this._getNextRetryDelay(n++,Date.now()-e,r)}}this._logger.log(l.Information,`Reconnect retries have been exhausted after ${Date.now()-e} ms and ${n} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(t,e,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:e,previousRetryCount:t,retryReason:n})}catch(n){return this._logger.log(l.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${t}, ${e}) threw error '${n}'.`),null}}_cancelCallbacksWithError(t){const e=this._callbacks;this._callbacks={},Object.keys(e).forEach((n=>{const r=e[n];try{r(null,t)}catch(e){this._logger.log(l.Error,`Stream 'error' callback called with '${t}' threw error: ${w(e)}`)}}))}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(t,e,n,r){if(n)return 0!==r.length?{arguments:e,streamIds:r,target:t,type:M.Invocation}:{arguments:e,target:t,type:M.Invocation};{const n=this._invocationId;return this._invocationId++,0!==r.length?{arguments:e,invocationId:n.toString(),streamIds:r,target:t,type:M.Invocation}:{arguments:e,invocationId:n.toString(),target:t,type:M.Invocation}}}_launchStreams(t,e){if(0!==t.length){e||(e=Promise.resolve());for(const n in t)t[n].subscribe({complete:()=>{e=e.then((()=>this._sendWithProtocol(this._createCompletionMessage(n))))},error:t=>{let r;r=t instanceof Error?t.message:t&&t.toString?t.toString():"Unknown error",e=e.then((()=>this._sendWithProtocol(this._createCompletionMessage(n,r))))},next:t=>{e=e.then((()=>this._sendWithProtocol(this._createStreamItemMessage(n,t))))}})}}_replaceStreamingParams(t){const e=[],n=[];for(let r=0;r<t.length;r++){const o=t[r];if(this._isObservable(o)){const i=this._invocationId;this._invocationId++,e[i]=o,n.push(i.toString()),t.splice(r,1)}}return[e,n]}_isObservable(t){return t&&t.subscribe&&"function"==typeof t.subscribe}_createStreamInvocation(t,e,n){const r=this._invocationId;return this._invocationId++,0!==n.length?{arguments:e,invocationId:r.toString(),streamIds:n,target:t,type:M.StreamInvocation}:{arguments:e,invocationId:r.toString(),target:t,type:M.StreamInvocation}}_createCancelInvocation(t){return{invocationId:t,type:M.CancelInvocation}}_createStreamItemMessage(t,e){return{invocationId:t,item:e,type:M.StreamItem}}_createCompletionMessage(t,e,n){return e?{error:e,invocationId:t,type:M.Completion}:{invocationId:t,result:n,type:M.Completion}}}const k=[0,2e3,1e4,3e4,null];class U{constructor(t){this._retryDelays=void 0!==t?[...t,null]:k}nextRetryDelayInMilliseconds(t){return this._retryDelays[t.previousRetryCount]}}class B{}var H,j;B.Authorization="Authorization",B.Cookie="Cookie",function(t){t[t.None=0]="None",t[t.WebSockets=1]="WebSockets",t[t.ServerSentEvents=2]="ServerSentEvents",t[t.LongPolling=4]="LongPolling"}(H||(H={})),function(t){t[t.Text=1]="Text",t[t.Binary=2]="Binary"}(j||(j={}));class V{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}}class G{constructor(t,e,n,r){this._httpClient=t,this._accessTokenFactory=e,this._logger=n,this._pollAbort=new V,this._options=r,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}async connect(e,n){if(_.isRequired(e,"url"),_.isRequired(n,"transferFormat"),_.isIn(n,j,"transferFormat"),this._url=e,this._logger.log(l.Trace,"(LongPolling transport) Connecting."),n===j.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[r,o]=S(),i={[r]:o,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:i,timeout:1e5,withCredentials:this._options.withCredentials};n===j.Binary&&(s.responseType="arraybuffer");const a=await this._getAccessToken();this._updateHeaderToken(s,a);const c=`${e}&_=${Date.now()}`;this._logger.log(l.Trace,`(LongPolling transport) polling: ${c}.`);const u=await this._httpClient.get(c,s);200!==u.statusCode?(this._logger.log(l.Error,`(LongPolling transport) Unexpected response code: ${u.statusCode}.`),this._closeError=new t(u.statusText||"",u.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _getAccessToken(){return this._accessTokenFactory?await this._accessTokenFactory():null}_updateHeaderToken(t,e){t.headers||(t.headers={}),e?t.headers[B.Authorization]=`Bearer ${e}`:t.headers[B.Authorization]&&delete t.headers[B.Authorization]}async _poll(n,r){try{for(;this._running;){const o=await this._getAccessToken();this._updateHeaderToken(r,o);try{const e=`${n}&_=${Date.now()}`;this._logger.log(l.Trace,`(LongPolling transport) polling: ${e}.`);const o=await this._httpClient.get(e,r);204===o.statusCode?(this._logger.log(l.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):200!==o.statusCode?(this._logger.log(l.Error,`(LongPolling transport) Unexpected response code: ${o.statusCode}.`),this._closeError=new t(o.statusText||"",o.statusCode),this._running=!1):o.content?(this._logger.log(l.Trace,`(LongPolling transport) data received. ${d(o.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(o.content)):this._logger.log(l.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(t){this._running?t instanceof e?this._logger.log(l.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=t,this._running=!1):this._logger.log(l.Trace,`(LongPolling transport) Poll errored after shutdown: ${t.message}`)}}}finally{this._logger.log(l.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(t){return this._running?g(this._logger,"LongPolling",this._httpClient,this._url,this._accessTokenFactory,t,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(l.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(l.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const t={},[e,n]=S();t[e]=n;const r={headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials},o=await this._getAccessToken();this._updateHeaderToken(r,o),await this._httpClient.delete(this._url,r),this._logger.log(l.Trace,"(LongPolling transport) DELETE request sent.")}finally{this._logger.log(l.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let t="(LongPolling transport) Firing onclose event.";this._closeError&&(t+=" Error: "+this._closeError),this._logger.log(l.Trace,t),this.onclose(this._closeError)}}}class F{constructor(t,e,n,r){this._httpClient=t,this._accessTokenFactory=e,this._logger=n,this._options=r,this.onreceive=null,this.onclose=null}async connect(t,e){if(_.isRequired(t,"url"),_.isRequired(e,"transferFormat"),_.isIn(e,j,"transferFormat"),this._logger.log(l.Trace,"(SSE transport) Connecting."),this._url=t,this._accessTokenFactory){const e=await this._accessTokenFactory();e&&(t+=(t.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(e)}`)}return new Promise(((n,r)=>{let o,i=!1;if(e===j.Text){if(f.isBrowser||f.isWebWorker)o=new this._options.EventSource(t,{withCredentials:this._options.withCredentials});else{const e=this._httpClient.getCookieString(t),n={};n.Cookie=e;const[r,i]=S();n[r]=i,o=new this._options.EventSource(t,{withCredentials:this._options.withCredentials,headers:{...n,...this._options.headers}})}try{o.onmessage=t=>{if(this.onreceive)try{this._logger.log(l.Trace,`(SSE transport) data received. ${d(t.data,this._options.logMessageContent)}.`),this.onreceive(t.data)}catch(t){return void this._close(t)}},o.onerror=t=>{i?this._close():r(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},o.onopen=()=>{this._logger.log(l.Information,`SSE connected to ${this._url}`),this._eventSource=o,i=!0,n()}}catch(t){return void r(t)}}else r(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))}async send(t){return this._eventSource?g(this._logger,"SSE",this._httpClient,this._url,this._accessTokenFactory,t,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(t){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(t))}}class W{constructor(t,e,n,r,o,i){this._logger=n,this._accessTokenFactory=e,this._logMessageContent=r,this._webSocketConstructor=o,this._httpClient=t,this.onreceive=null,this.onclose=null,this._headers=i}async connect(t,e){if(_.isRequired(t,"url"),_.isRequired(e,"transferFormat"),_.isIn(e,j,"transferFormat"),this._logger.log(l.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory){const e=await this._accessTokenFactory();e&&(t+=(t.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(e)}`)}return new Promise(((n,r)=>{let o;t=t.replace(/^http/,"ws");const i=this._httpClient.getCookieString(t);let s=!1;if(f.isNode){const e={},[n,r]=S();e[n]=r,i&&(e[B.Cookie]=`${i}`),o=new this._webSocketConstructor(t,void 0,{headers:{...e,...this._headers}})}o||(o=new this._webSocketConstructor(t)),e===j.Binary&&(o.binaryType="arraybuffer"),o.onopen=e=>{this._logger.log(l.Information,`WebSocket connected to ${t}.`),this._webSocket=o,s=!0,n()},o.onerror=t=>{let e=null;e="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:"There was an error with the transport",this._logger.log(l.Information,`(WebSockets transport) ${e}.`)},o.onmessage=t=>{if(this._logger.log(l.Trace,`(WebSockets transport) data received. ${d(t.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(t.data)}catch(t){return void this._close(t)}},o.onclose=t=>{if(s)this._close(t);else{let e=null;e="undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent?t.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",r(new Error(e))}}}))}send(t){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(l.Trace,`(WebSockets transport) sending data. ${d(t,this._logMessageContent)}.`),this._webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(t){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(l.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(t)||!1!==t.wasClean&&1e3===t.code?t instanceof Error?this.onclose(t):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${t.code} (${t.reason||"no reason given"}).`)))}_isCloseEvent(t){return t&&"boolean"==typeof t.wasClean&&"number"==typeof t.code}}class ${constructor(t,e={}){var n;if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,_.isRequired(t,"url"),this._logger=void 0===(n=e.logger)?new m(l.Information):null===n?p.instance:void 0!==n.log?n:new m(n),this.baseUrl=this._resolveUrl(t),(e=e||{}).logMessageContent=void 0!==e.logMessageContent&&e.logMessageContent,"boolean"!=typeof e.withCredentials&&void 0!==e.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");e.withCredentials=void 0===e.withCredentials||e.withCredentials,e.timeout=void 0===e.timeout?1e5:e.timeout;let r=null,o=null;if(f.isNode&&"undefined"!=typeof require){const t="function"==typeof __webpack_require__?__non_webpack_require__:require;r=t("ws"),o=t("eventsource")}f.isNode||"undefined"==typeof WebSocket||e.WebSocket?f.isNode&&!e.WebSocket&&r&&(e.WebSocket=r):e.WebSocket=WebSocket,f.isNode||"undefined"==typeof EventSource||e.EventSource?f.isNode&&!e.EventSource&&void 0!==o&&(e.EventSource=o):e.EventSource=EventSource,this._httpClient=e.httpClient||new N(this._logger),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=e,this.onreceive=null,this.onclose=null}async start(t){if(t=t||j.Binary,_.isIn(t,j,"transferFormat"),this._logger.log(l.Debug,`Starting connection with transfer format '${j[t]}'.`),"Disconnected"!==this._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(t),await this._startInternalPromise,"Disconnecting"===this._connectionState){const t="Failed to start the HttpConnection before stop() was called.";return this._logger.log(l.Error,t),await this._stopPromise,Promise.reject(new Error(t))}if("Connected"!==this._connectionState){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(l.Error,t),Promise.reject(new Error(t))}this._connectionStarted=!0}send(t){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new X(this.transport)),this._sendQueue.send(t))}async stop(t){return"Disconnected"===this._connectionState?(this._logger.log(l.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===this._connectionState?(this._logger.log(l.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise((t=>{this._stopPromiseResolver=t})),await this._stopInternal(t),void await this._stopPromise)}async _stopInternal(t){this._stopError=t;try{await this._startInternalPromise}catch(t){}if(this.transport){try{await this.transport.stop()}catch(t){this._logger.log(l.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(l.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(t){let e=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==H.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(H.WebSockets),await this._startTransport(e,t)}else{let n=null,r=0;do{if(n=await this._getNegotiationResponse(e),"Disconnecting"===this._connectionState||"Disconnected"===this._connectionState)throw new Error("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(n.url&&(e=n.url),n.accessToken){const t=n.accessToken;this._accessTokenFactory=()=>t}r++}while(n.url&&r<100);if(100===r&&n.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(e,this._options.transport,n,t)}this.transport instanceof G&&(this.features.inherentKeepAlive=!0),"Connecting"===this._connectionState&&(this._logger.log(l.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(t){return this._logger.log(l.Error,"Failed to start the connection: "+t),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(t)}}async _getNegotiationResponse(e){const n={};if(this._accessTokenFactory){const t=await this._accessTokenFactory();t&&(n[B.Authorization]=`Bearer ${t}`)}const[r,o]=S();n[r]=o;const i=this._resolveNegotiateUrl(e);this._logger.log(l.Debug,`Sending negotiation request: ${i}.`);try{const t=await this._httpClient.post(i,{content:"",headers:{...n,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(200!==t.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${t.statusCode}'`));const e=JSON.parse(t.content);return(!e.negotiateVersion||e.negotiateVersion<1)&&(e.connectionToken=e.connectionId),e}catch(e){let n="Failed to complete negotiation with the server: "+e;return e instanceof t&&404===e.statusCode&&(n+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(l.Error,n),Promise.reject(new s(n))}}_createConnectUrl(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+`id=${e}`:t}async _createTransport(t,e,n,r){let o=this._createConnectUrl(t,n.connectionToken);if(this._isITransport(e))return this._logger.log(l.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=e,await this._startTransport(o,r),void(this.connectionId=n.connectionId);const s=[],c=n.availableTransports||[];let u=n;for(const n of c){const a=this._resolveTransportOrError(n,e,r);if(a instanceof Error)s.push(`${n.transport} failed:`),s.push(a);else if(this._isITransport(a)){if(this.transport=a,!u){try{u=await this._getNegotiationResponse(t)}catch(t){return Promise.reject(t)}o=this._createConnectUrl(t,u.connectionToken)}try{return await this._startTransport(o,r),void(this.connectionId=u.connectionId)}catch(t){if(this._logger.log(l.Error,`Failed to start the transport '${n.transport}': ${t}`),u=void 0,s.push(new i(`${n.transport} failed: ${t}`,H[n.transport])),"Connecting"!==this._connectionState){const t="Failed to select transport before stop() was called.";return this._logger.log(l.Debug,t),Promise.reject(new Error(t))}}}}return s.length>0?Promise.reject(new a(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(t){switch(t){case H.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new W(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case H.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new F(this._httpClient,this._accessTokenFactory,this._logger,this._options);case H.LongPolling:return new G(this._httpClient,this._accessTokenFactory,this._logger,this._options);default:throw new Error(`Unknown transport: ${t}.`)}}_startTransport(t,e){return this.transport.onreceive=this.onreceive,this.transport.onclose=t=>this._stopConnection(t),this.transport.connect(t,e)}_resolveTransportOrError(t,e,n){const i=H[t.transport];if(null==i)return this._logger.log(l.Debug,`Skipping transport '${t.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${t.transport}' because it is not supported by this client.`);if(!function(t,e){return!t||0!=(e&t)}(e,i))return this._logger.log(l.Debug,`Skipping transport '${H[i]}' because it was disabled by the client.`),new o(`'${H[i]}' is disabled by the client.`,i);if(!(t.transferFormats.map((t=>j[t])).indexOf(n)>=0))return this._logger.log(l.Debug,`Skipping transport '${H[i]}' because it does not support the requested transfer format '${j[n]}'.`),new Error(`'${H[i]}' does not support ${j[n]}.`);if(i===H.WebSockets&&!this._options.WebSocket||i===H.ServerSentEvents&&!this._options.EventSource)return this._logger.log(l.Debug,`Skipping transport '${H[i]}' because it is not supported in your environment.'`),new r(`'${H[i]}' is not supported in your environment.`,i);this._logger.log(l.Debug,`Selecting transport '${H[i]}'.`);try{return this._constructTransport(i)}catch(t){return t}}_isITransport(t){return t&&"object"==typeof t&&"connect"in t}_stopConnection(t){if(this._logger.log(l.Debug,`HttpConnection.stopConnection(${t}) called while in state ${this._connectionState}.`),this.transport=void 0,t=this._stopError||t,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(l.Warning,`Call to HttpConnection.stopConnection(${t}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${t}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),t?this._logger.log(l.Error,`Connection disconnected with error '${t}'.`):this._logger.log(l.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch((t=>{this._logger.log(l.Error,`TransportSendQueue.stop() threw error '${t}'.`)})),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(t)}catch(e){this._logger.log(l.Error,`HttpConnection.onclose(${t}) threw error '${e}'.`)}}}else this._logger.log(l.Debug,`Call to HttpConnection.stopConnection(${t}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if(!f.isBrowser)throw new Error(`Cannot resolve '${t}'.`);const e=window.document.createElement("a");return e.href=t,this._logger.log(l.Information,`Normalizing '${t}' to '${e.href}'.`),e.href}_resolveNegotiateUrl(t){const e=t.indexOf("?");let n=t.substring(0,-1===e?t.length:e);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",n+=-1===e?"":t.substring(e),-1===n.indexOf("negotiateVersion")&&(n+=-1===e?"?":"&",n+="negotiateVersion="+this._negotiateVersion),n}}class X{constructor(t){this._transport=t,this._buffer=[],this._executing=!0,this._sendBufferedData=new K,this._transportResult=new K,this._sendLoopPromise=this._sendLoop()}send(t){return this._bufferData(t),this._transportResult||(this._transportResult=new K),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(t){if(this._buffer.length&&typeof this._buffer[0]!=typeof t)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof t}`);this._buffer.push(t),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new K;const t=this._transportResult;this._transportResult=void 0;const e="string"==typeof this._buffer[0]?this._buffer.join(""):X._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(e),t.resolve()}catch(e){t.reject(e)}}}static _concatBuffers(t){const e=t.map((t=>t.byteLength)).reduce(((t,e)=>t+e)),n=new Uint8Array(e);let r=0;for(const e of t)n.set(new Uint8Array(e),r),r+=e.byteLength;return n.buffer}}class K{constructor(){this.promise=new Promise(((t,e)=>[this._resolver,this._rejecter]=[t,e]))}resolve(){this._resolver()}reject(t){this._rejecter(t)}}class Y{constructor(){this.name="json",this.version=1,this.transferFormat=j.Text}parseMessages(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=p.instance);const n=I.parse(t),r=[];for(const t of n){const n=JSON.parse(t);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case M.Invocation:this._isInvocationMessage(n);break;case M.StreamItem:this._isStreamItemMessage(n);break;case M.Completion:this._isCompletionMessage(n);break;case M.Ping:case M.Close:break;default:e.log(l.Information,"Unknown message type '"+n.type+"' ignored.");continue}r.push(n)}return r}writeMessage(t){return I.write(JSON.stringify(t))}_isInvocationMessage(t){this._assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this._assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(t){if(this._assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this._assertNotEmptyString(t.error,"Invalid payload for Completion message."),this._assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(t,e){if("string"!=typeof t||""===t)throw new Error(e)}}const q={trace:l.Trace,debug:l.Debug,info:l.Information,information:l.Information,warn:l.Warning,warning:l.Warning,error:l.Error,critical:l.Critical,none:l.None};var z=Object.freeze({__proto__:null,AbortError:n,HttpError:t,TimeoutError:e,HttpClient:u,HttpResponse:c,DefaultHttpClient:N,HubConnection:x,get HubConnectionState(){return D},HubConnectionBuilder:class{configureLogging(t){if(_.isRequired(t,"logging"),void 0!==t.log)this.logger=t;else if("string"==typeof t){const e=function(t){const e=q[t.toLowerCase()];if(void 0!==e)return e;throw new Error(`Unknown log level: ${t}`)}(t);this.logger=new m(e)}else this.logger=new m(t);return this}withUrl(t,e){return _.isRequired(t,"url"),_.isNotEmpty(t,"url"),this.url=t,this.httpConnectionOptions="object"==typeof e?{...this.httpConnectionOptions,...e}:{...this.httpConnectionOptions,transport:e},this}withHubProtocol(t){return _.isRequired(t,"protocol"),this.protocol=t,this}withAutomaticReconnect(t){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return t?Array.isArray(t)?this.reconnectPolicy=new U(t):this.reconnectPolicy=t:this.reconnectPolicy=new U,this}build(){const t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const e=new $(this.url,t);return x.create(e,this.logger||p.instance,this.protocol||new Y,this.reconnectPolicy)}},get MessageType(){return M},get LogLevel(){return l},get HttpTransportType(){return H},get TransferFormat(){return j},NullLogger:p,JsonHubProtocol:Y,Subject:L,VERSION:h}),J="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},Q="1.1.0",Z=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var tt=function(t){var e=new Set([t]),n=new Set,r=t.match(Z);if(!r)return function(){return!1};var o=+r[1],i=+r[2],s=+r[3];if(null!=r[4])return function(e){return e===t};function a(t){return n.add(t),!1}function c(t){return e.add(t),!0}return function(t){if(e.has(t))return!0;if(n.has(t))return!1;var r=t.match(Z);if(!r)return a(t);var u=+r[1],l=+r[2],p=+r[3];return null!=r[4]||o!==u?a(t):0===o?i===l&&s<=p?c(t):a(t):i<=l?c(t):a(t)}}(Q),et=Q.split(".")[0],nt=Symbol.for("opentelemetry.js.api."+et),rt=J;function ot(t,e,n,r){var o;void 0===r&&(r=!1);var i=rt[nt]=null!==(o=rt[nt])&&void 0!==o?o:{version:Q};if(!r&&i[t]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return n.error(s.stack||s.message),!1}if(i.version!==Q){s=new Error("@opentelemetry/api: All API registration versions must match");return n.error(s.stack||s.message),!1}return i[t]=e,n.debug("@opentelemetry/api: Registered a global for "+t+" v"+"1.1.0."),!0}function it(t){var e,n,r=null===(e=rt[nt])||void 0===e?void 0:e.version;if(r&&tt(r))return null===(n=rt[nt])||void 0===n?void 0:n[t]}function st(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+"1.1.0.");var n=rt[nt];n&&delete n[t]}var at,ct=function(){function t(t){this._namespace=t.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ut("debug",this._namespace,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ut("error",this._namespace,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ut("info",this._namespace,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ut("warn",this._namespace,t)},t.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ut("verbose",this._namespace,t)},t}();function ut(t,e,n){var r=it("diag");if(r)return n.unshift(e),r[t].apply(r,n)}!function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"}(at||(at={}));var lt=function(){function t(){function t(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=it("diag");if(r)return r[t].apply(r,e)}}var e=this;e.setLogger=function(t,n){var r,o;if(void 0===n&&(n=at.INFO),t===e){var i=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return e.error(null!==(r=i.stack)&&void 0!==r?r:i.message),!1}var s=it("diag"),a=function(t,e){function n(n,r){var o=e[n];return"function"==typeof o&&t>=r?o.bind(e):function(){}}return t<at.NONE?t=at.NONE:t>at.ALL&&(t=at.ALL),e=e||{},{error:n("error",at.ERROR),warn:n("warn",at.WARN),info:n("info",at.INFO),debug:n("debug",at.DEBUG),verbose:n("verbose",at.VERBOSE)}}(n,t);if(s){var c=null!==(o=(new Error).stack)&&void 0!==o?o:"<failed to generate stacktrace>";s.warn("Current logger will be overwritten from "+c),a.warn("Current logger will overwrite one already registered from "+c)}return ot("diag",a,e,!0)},e.disable=function(){st("diag",e)},e.createComponentLogger=function(t){return new ct(t)},e.verbose=t("verbose"),e.debug=t("debug"),e.info=t("info"),e.warn=t("warn"),e.error=t("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}(),pt=function(){function t(t){this._entries=t?new Map(t):new Map}return t.prototype.getEntry=function(t){var e=this._entries.get(t);if(e)return Object.assign({},e)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(t){return[t[0],t[1]]}))},t.prototype.setEntry=function(e,n){var r=new t(this._entries);return r._entries.set(e,n),r},t.prototype.removeEntry=function(e){var n=new t(this._entries);return n._entries.delete(e),n},t.prototype.removeEntries=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=new t(this._entries),o=0,i=e;o<i.length;o++){var s=i[o];r._entries.delete(s)}return r},t.prototype.clear=function(){return new t},t}(),ht=Symbol("BaggageEntryMetadata"),_t=lt.instance();function ft(t){return void 0===t&&(t={}),new pt(new Map(Object.entries(t)))}var dt={get:function(t,e){if(null!=t)return t[e]},keys:function(t){return null==t?[]:Object.keys(t)}},Et={set:function(t,e,n){null!=t&&(t[e]=n)}};function gt(t){return Symbol.for(t)}var yt,mt=function t(e){var n=this;n._currentContext=e?new Map(e):new Map,n.getValue=function(t){return n._currentContext.get(t)},n.setValue=function(e,r){var o=new t(n._currentContext);return o._currentContext.set(e,r),o},n.deleteValue=function(e){var r=new t(n._currentContext);return r._currentContext.delete(e),r}},St=new mt,vt=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Tt=function(){function t(){}return t.prototype.active=function(){return St},t.prototype.with=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return e.call.apply(e,vt([n],r))},t.prototype.bind=function(t,e){return e},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}(),bt=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},Ot="context",wt=new Tt,At=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return ot(Ot,t,lt.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e,n){for(var r,o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];return(r=this._getContextManager()).with.apply(r,bt([t,e,n],o))},t.prototype.bind=function(t,e){return this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){return it(Ot)||wt},t.prototype.disable=function(){this._getContextManager().disable(),st(Ot,lt.instance())},t}();!function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"}(yt||(yt={}));var Ct="0000000000000000",Rt="00000000000000000000000000000000",Nt={traceId:Rt,spanId:Ct,traceFlags:yt.NONE},It=function(){function t(t){void 0===t&&(t=Nt),this._spanContext=t}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),Pt=gt("OpenTelemetry Context Key SPAN");function Mt(t){return t.getValue(Pt)||void 0}function Lt(t,e){return t.setValue(Pt,e)}function Dt(t){return t.deleteValue(Pt)}function xt(t,e){return Lt(t,new It(e))}function kt(t){var e;return null===(e=Mt(t))||void 0===e?void 0:e.spanContext()}var Ut=/^([0-9a-f]{32})$/i,Bt=/^[0-9a-f]{16}$/i;function Ht(t){return Ut.test(t)&&t!==Rt}function jt(t){return Ht(t.traceId)&&(e=t.spanId,Bt.test(e)&&e!==Ct);var e}function Vt(t){return new It(t)}var Gt=At.getInstance(),Ft=function(){function t(){}return t.prototype.startSpan=function(t,e,n){if(Boolean(null==e?void 0:e.root))return new It;var r,o=n&&kt(n);return"object"==typeof(r=o)&&"string"==typeof r.spanId&&"string"==typeof r.traceId&&"number"==typeof r.traceFlags&&jt(o)?new It(o):new It},t.prototype.startActiveSpan=function(t,e,n,r){var o,i,s;if(!(arguments.length<2)){2===arguments.length?s=e:3===arguments.length?(o=e,s=n):(o=e,i=n,s=r);var a=null!=i?i:Gt.active(),c=this.startSpan(t,o,a),u=Lt(a,c);return Gt.with(u,s,void 0,c)}},t}();var Wt,$t,Xt,Kt=new Ft,Yt=function(){function t(t,e,n,r){this._provider=t,this.name=e,this.version=n,this.options=r}return t.prototype.startSpan=function(t,e,n){return this._getTracer().startSpan(t,e,n)},t.prototype.startActiveSpan=function(t,e,n,r){var o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Kt},t}(),qt=new(function(){function t(){}return t.prototype.getTracer=function(t,e,n){return new Ft},t}()),zt=function(){function t(){}return t.prototype.getTracer=function(t,e,n){var r;return null!==(r=this.getDelegateTracer(t,e,n))&&void 0!==r?r:new Yt(this,t,e,n)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:qt},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(t,e,n)},t}();!function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Wt||(Wt={})),function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"}($t||($t={})),function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"}(Xt||(Xt={}));var Jt="trace",Qt=function(){function t(){this._proxyTracerProvider=new zt,this.wrapSpanContext=Vt,this.isSpanContextValid=jt,this.deleteSpan=Dt,this.getSpan=Mt,this.getSpanContext=kt,this.setSpan=Lt,this.setSpanContext=xt}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){var e=ot(Jt,this._proxyTracerProvider,lt.instance());return e&&this._proxyTracerProvider.setDelegate(t),e},t.prototype.getTracerProvider=function(){return it(Jt)||this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){st(Jt,lt.instance()),this._proxyTracerProvider=new zt},t}(),Zt=function(){function t(){}return t.prototype.inject=function(t,e){},t.prototype.extract=function(t,e){return t},t.prototype.fields=function(){return[]},t}(),te=gt("OpenTelemetry Baggage Key");function ee(t){return t.getValue(te)||void 0}function ne(t,e){return t.setValue(te,e)}function re(t){return t.deleteValue(te)}var oe="propagation",ie=new Zt,se=function(){function t(){this.createBaggage=ft,this.getBaggage=ee,this.setBaggage=ne,this.deleteBaggage=re}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(t){return ot(oe,t,lt.instance())},t.prototype.inject=function(t,e,n){return void 0===n&&(n=Et),this._getGlobalPropagator().inject(t,e,n)},t.prototype.extract=function(t,e,n){return void 0===n&&(n=dt),this._getGlobalPropagator().extract(t,e,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){st(oe,lt.instance())},t.prototype._getGlobalPropagator=function(){return it(oe)||ie},t}(),ae=At.getInstance(),ce=Qt.getInstance(),ue=se.getInstance(),le=lt.instance(),pe={trace:ce,context:ae,propagation:ue,diag:le},he={AWS_LAMBDA_INVOKED_ARN:"aws.lambda.invoked_arn",DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",NET_HOST_CONNECTION_TYPE:"net.host.connection.type",NET_HOST_CONNECTION_SUBTYPE:"net.host.connection.subtype",NET_HOST_CARRIER_NAME:"net.host.carrier.name",NET_HOST_CARRIER_MCC:"net.host.carrier.mcc",NET_HOST_CARRIER_MNC:"net.host.carrier.mnc",NET_HOST_CARRIER_ICC:"net.host.carrier.icc",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_CONSUMER_ID:"messaging.consumer_id",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message",MESSAGE_TYPE:"message.type",MESSAGE_ID:"message.id",MESSAGE_COMPRESSED_SIZE:"message.compressed_size",MESSAGE_UNCOMPRESSED_SIZE:"message.uncompressed_size"},_e={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"},fe={CPP:"cpp",DOTNET:"dotnet",ERLANG:"erlang",GO:"go",JAVA:"java",NODEJS:"nodejs",PHP:"php",PYTHON:"python",RUBY:"ruby",WEBJS:"webjs"},de=Object.freeze({__proto__:null,SemanticAttributes:he,DbSystemValues:{OTHER_SQL:"other_sql",MSSQL:"mssql",MYSQL:"mysql",ORACLE:"oracle",DB2:"db2",POSTGRESQL:"postgresql",REDSHIFT:"redshift",HIVE:"hive",CLOUDSCAPE:"cloudscape",HSQLDB:"hsqldb",PROGRESS:"progress",MAXDB:"maxdb",HANADB:"hanadb",INGRES:"ingres",FIRSTSQL:"firstsql",EDB:"edb",CACHE:"cache",ADABAS:"adabas",FIREBIRD:"firebird",DERBY:"derby",FILEMAKER:"filemaker",INFORMIX:"informix",INSTANTDB:"instantdb",INTERBASE:"interbase",MARIADB:"mariadb",NETEZZA:"netezza",PERVASIVE:"pervasive",POINTBASE:"pointbase",SQLITE:"sqlite",SYBASE:"sybase",TERADATA:"teradata",VERTICA:"vertica",H2:"h2",COLDFUSION:"coldfusion",CASSANDRA:"cassandra",HBASE:"hbase",MONGODB:"mongodb",REDIS:"redis",COUCHBASE:"couchbase",COUCHDB:"couchdb",COSMOSDB:"cosmosdb",DYNAMODB:"dynamodb",NEO4J:"neo4j",GEODE:"geode",ELASTICSEARCH:"elasticsearch",MEMCACHED:"memcached",COCKROACHDB:"cockroachdb"},DbCassandraConsistencyLevelValues:{ALL:"all",EACH_QUORUM:"each_quorum",QUORUM:"quorum",LOCAL_QUORUM:"local_quorum",ONE:"one",TWO:"two",THREE:"three",LOCAL_ONE:"local_one",ANY:"any",SERIAL:"serial",LOCAL_SERIAL:"local_serial"},FaasTriggerValues:{DATASOURCE:"datasource",HTTP:"http",PUBSUB:"pubsub",TIMER:"timer",OTHER:"other"},FaasDocumentOperationValues:{INSERT:"insert",EDIT:"edit",DELETE:"delete"},FaasInvokedProviderValues:{ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},NetTransportValues:{IP_TCP:"ip_tcp",IP_UDP:"ip_udp",IP:"ip",UNIX:"unix",PIPE:"pipe",INPROC:"inproc",OTHER:"other"},NetHostConnectionTypeValues:{WIFI:"wifi",WIRED:"wired",CELL:"cell",UNAVAILABLE:"unavailable",UNKNOWN:"unknown"},NetHostConnectionSubtypeValues:{GPRS:"gprs",EDGE:"edge",UMTS:"umts",CDMA:"cdma",EVDO_0:"evdo_0",EVDO_A:"evdo_a",CDMA2000_1XRTT:"cdma2000_1xrtt",HSDPA:"hsdpa",HSUPA:"hsupa",HSPA:"hspa",IDEN:"iden",EVDO_B:"evdo_b",LTE:"lte",EHRPD:"ehrpd",HSPAP:"hspap",GSM:"gsm",TD_SCDMA:"td_scdma",IWLAN:"iwlan",NR:"nr",NRNSA:"nrnsa",LTE_CA:"lte_ca"},HttpFlavorValues:{HTTP_1_0:"1.0",HTTP_1_1:"1.1",HTTP_2_0:"2.0",SPDY:"SPDY",QUIC:"QUIC"},MessagingDestinationKindValues:{QUEUE:"queue",TOPIC:"topic"},MessagingOperationValues:{RECEIVE:"receive",PROCESS:"process"},RpcGrpcStatusCodeValues:{OK:0,CANCELLED:1,UNKNOWN:2,INVALID_ARGUMENT:3,DEADLINE_EXCEEDED:4,NOT_FOUND:5,ALREADY_EXISTS:6,PERMISSION_DENIED:7,RESOURCE_EXHAUSTED:8,FAILED_PRECONDITION:9,ABORTED:10,OUT_OF_RANGE:11,UNIMPLEMENTED:12,INTERNAL:13,UNAVAILABLE:14,DATA_LOSS:15,UNAUTHENTICATED:16},MessageTypeValues:{SENT:"SENT",RECEIVED:"RECEIVED"},SemanticResourceAttributes:_e,CloudProviderValues:{ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},CloudPlatformValues:{ALIBABA_CLOUD_ECS:"alibaba_cloud_ecs",ALIBABA_CLOUD_FC:"alibaba_cloud_fc",AWS_EC2:"aws_ec2",AWS_ECS:"aws_ecs",AWS_EKS:"aws_eks",AWS_LAMBDA:"aws_lambda",AWS_ELASTIC_BEANSTALK:"aws_elastic_beanstalk",AZURE_VM:"azure_vm",AZURE_CONTAINER_INSTANCES:"azure_container_instances",AZURE_AKS:"azure_aks",AZURE_FUNCTIONS:"azure_functions",AZURE_APP_SERVICE:"azure_app_service",GCP_COMPUTE_ENGINE:"gcp_compute_engine",GCP_CLOUD_RUN:"gcp_cloud_run",GCP_KUBERNETES_ENGINE:"gcp_kubernetes_engine",GCP_CLOUD_FUNCTIONS:"gcp_cloud_functions",GCP_APP_ENGINE:"gcp_app_engine"},AwsEcsLaunchtypeValues:{EC2:"ec2",FARGATE:"fargate"},HostArchValues:{AMD64:"amd64",ARM32:"arm32",ARM64:"arm64",IA64:"ia64",PPC32:"ppc32",PPC64:"ppc64",X86:"x86"},OsTypeValues:{WINDOWS:"windows",LINUX:"linux",DARWIN:"darwin",FREEBSD:"freebsd",NETBSD:"netbsd",OPENBSD:"openbsd",DRAGONFLYBSD:"dragonflybsd",HPUX:"hpux",AIX:"aix",SOLARIS:"solaris",Z_OS:"z_os"},TelemetrySdkLanguageValues:fe}),Ee=gt("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function ge(t){return t.setValue(Ee,!0)}function ye(t){return!0===t.getValue(Ee)}var me=",",Se="baggage",ve=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Te(t){return t.reduce((function(t,e){var n=""+t+(""!==t?me:"")+e;return n.length>8192?t:n}),"")}function be(t){return t.getAllEntries().map((function(t){var e=ve(t,2),n=e[0],r=e[1],o=encodeURIComponent(n)+"="+encodeURIComponent(r.value);return void 0!==r.metadata&&(o+=";"+r.metadata.toString()),o}))}function Oe(t){var e=t.split(";");if(!(e.length<=0)){var n=e.shift();if(n){var r=n.split("=");if(2===r.length){var o,i,s=decodeURIComponent(r[0].trim()),a=decodeURIComponent(r[1].trim());return e.length>0&&("string"!=typeof(i=e.join(";"))&&(_t.error("Cannot create baggage metadata from unknown type: "+typeof i),i=""),o={__TYPE__:ht,toString:function(){return i}}),{key:s,value:a,metadata:o}}}}}function we(t){return"string"!=typeof t||0===t.length?{}:t.split(me).map((function(t){return Oe(t)})).filter((function(t){return void 0!==t&&t.value.length>0})).reduce((function(t,e){return t[e.key]=e.value,t}),{})}var Ae=Object.freeze({__proto__:null,serializeKeyPairs:Te,getKeyPairs:be,parsePairKeyValue:Oe,parseKeyPairsIntoRecord:we}),Ce=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=ue.getBaggage(t);if(r&&!ye(t)){var o=Te(be(r).filter((function(t){return t.length<=4096})).slice(0,180));o.length>0&&n.set(e,Se,o)}},t.prototype.extract=function(t,e,n){var r=n.get(e,Se),o=Array.isArray(r)?r.join(me):r;if(!o)return t;var i={};return 0===o.length?t:(o.split(me).forEach((function(t){var e=Oe(t);if(e){var n={value:e.value};e.metadata&&(n.metadata=e.metadata),i[e.key]=n}})),0===Object.entries(i).length?t:ue.setBaggage(t,ue.createBaggage(i)))},t.prototype.fields=function(){return[Se]},t}(),Re=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ne=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Ie(t){var e,n,r={};if("object"!=typeof t||null==t)return r;try{for(var o=Re(Object.entries(t)),i=o.next();!i.done;i=o.next()){var s=Ne(i.value,2),a=s[0],c=s[1];Pe(a)?Me(c)?Array.isArray(c)?r[a]=c.slice():r[a]=c:le.warn("Invalid attribute value set for key: "+a):le.warn("Invalid attribute key: "+a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}function Pe(t){return"string"==typeof t&&t.length>0}function Me(t){return null==t||(Array.isArray(t)?function(t){var e,n,r;try{for(var o=Re(t),i=o.next();!i.done;i=o.next()){var s=i.value;if(null!=s){if(!r){if(Le(s)){r=typeof s;continue}return!1}if(typeof s!==r)return!1}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!0}(t):Le(t))}function Le(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}function De(){return function(t){le.error(function(t){return"string"==typeof t?t:JSON.stringify(function(t){var e={},n=t;for(;null!==n;)Object.getOwnPropertyNames(n).forEach((function(t){if(!e[t]){var r=n[t];r&&(e[t]=String(r))}})),n=Object.getPrototypeOf(n);return e}(t))}(t))}}var xe,ke=De();function Ue(t){try{ke(t)}catch(t){}}!function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"}(xe||(xe={}));var Be=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function He(t){return Be.indexOf(t)>-1}var je=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function Ve(t){return je.indexOf(t)>-1}var Ge=1/0,Fe={CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:at.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:Ge,OTEL_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:Ge,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"none",OTEL_TRACES_SAMPLER:xe.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:""};function We(t,e,n,r,o){if(void 0===r&&(r=-1/0),void 0===o&&(o=1/0),void 0!==n[t]){var i=Number(n[t]);isNaN(i)||(e[t]=i<r?r:i>o?o:i)}}function $e(t,e,n,r){void 0===r&&(r=",");var o=n[t];"string"==typeof o&&(e[t]=o.split(r).map((function(t){return t.trim()})))}var Xe={ALL:at.ALL,VERBOSE:at.VERBOSE,DEBUG:at.DEBUG,INFO:at.INFO,WARN:at.WARN,ERROR:at.ERROR,NONE:at.NONE};function Ke(t,e,n){var r=n[t];if("string"==typeof r){var o=Xe[r.toUpperCase()];null!=o&&(e[t]=o)}}function Ye(t){var e={};for(var n in Fe){var r=n;if("OTEL_LOG_LEVEL"===r)Ke(r,e,t);else if(He(r))We(r,e,t);else if(Ve(r))$e(r,e,t);else{var o=t[r];null!=o&&(e[r]=String(o))}}return e}var qe="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{};function ze(){var t=Ye(qe);return Object.assign({},Fe,t)}function Je(t){for(var e=t.length,n="",r=0;r<e;r+=2){var o=t.substring(r,r+2),i=parseInt(o,16);n+=String.fromCharCode(i)}return btoa(n)}var Qe=function(){this.generateTraceId=tn(16),this.generateSpanId=tn(8)},Ze=Array(32);function tn(t){return function(){for(var e=0;e<2*t;e++)Ze[e]=Math.floor(16*Math.random())+48,Ze[e]>=58&&(Ze[e]+=39);return String.fromCharCode.apply(null,Ze.slice(0,2*t))}}var en,nn=performance,rn="1.5.0",on=((en={})[_e.TELEMETRY_SDK_NAME]="opentelemetry",en[_e.PROCESS_RUNTIME_NAME]="browser",en[_e.TELEMETRY_SDK_LANGUAGE]=fe.WEBJS,en[_e.TELEMETRY_SDK_VERSION]=rn,en);function sn(t){}var an,cn=Math.pow(10,9);function un(t){var e=t/1e3,n=Math.trunc(e);return[n,Number((e-n).toFixed(9))*cn]}function ln(){var t=nn.timeOrigin;if("number"!=typeof t){var e=nn;t=e.timing&&e.timing.fetchStart}return t}function pn(t){var e=un(ln()),n=un("number"==typeof t?t:nn.now()),r=e[0]+n[0],o=e[1]+n[1];return o>cn&&(o-=cn,r+=1),[r,o]}function hn(t){if(En(t))return t;if("number"==typeof t)return t<ln()?pn(t):un(t);if(t instanceof Date)return un(t.getTime());throw TypeError("Invalid input type")}function _n(t,e){var n=e[0]-t[0],r=e[1]-t[1];return r<0&&(n-=1,r+=cn),[n,r]}function fn(t){return t[0]*cn+t[1]}function dn(t){return Math.round(1e6*t[0]+t[1]/1e3)}function En(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function gn(t){return En(t)||"number"==typeof t||t instanceof Date}!function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"}(an||(an={}));var yn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mn=function(){function t(t){var e;void 0===t&&(t={}),this._propagators=null!==(e=t.propagators)&&void 0!==e?e:[],this._fields=Array.from(new Set(this._propagators.map((function(t){return"function"==typeof t.fields?t.fields():[]})).reduce((function(t,e){return t.concat(e)}),[])))}return t.prototype.inject=function(t,e,n){var r,o;try{for(var i=yn(this._propagators),s=i.next();!s.done;s=i.next()){var a=s.value;try{a.inject(t,e,n)}catch(t){le.warn("Failed to inject with "+a.constructor.name+". Err: "+t.message)}}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}},t.prototype.extract=function(t,e,n){return this._propagators.reduce((function(t,r){try{return r.extract(t,e,n)}catch(t){le.warn("Failed to inject with "+r.constructor.name+". Err: "+t.message)}return t}),t)},t.prototype.fields=function(){return this._fields.slice()},t}(),Sn=new RegExp("^(?:[a-z][_0-9a-z-*/]{0,255}|[a-z0-9][_0-9a-z-*/]{0,240}@[a-z][_0-9a-z-*/]{0,13})$"),vn=/^[ -~]{0,255}[!-~]$/,Tn=/,|=/;var bn=function(){function t(t){this._internalState=new Map,t&&this._parse(t)}return t.prototype.set=function(t,e){var n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,e),n},t.prototype.unset=function(t){var e=this._clone();return e._internalState.delete(t),e},t.prototype.get=function(t){return this._internalState.get(t)},t.prototype.serialize=function(){var t=this;return this._keys().reduce((function(e,n){return e.push(n+"="+t.get(n)),e}),[]).join(",")},t.prototype._parse=function(t){t.length>512||(this._internalState=t.split(",").reverse().reduce((function(t,e){var n=e.trim(),r=n.indexOf("=");if(-1!==r){var o=n.slice(0,r),i=n.slice(r+1,e.length);(function(t){return Sn.test(t)})(o)&&function(t){return vn.test(t)&&!Tn.test(t)}(i)&&t.set(o,i)}return t}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}(),On="traceparent",wn="tracestate",An=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");function Cn(t){var e=An.exec(t);return e?"00"===e[1]&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}:null}var Rn,Nn=function(){function t(){}return t.prototype.inject=function(t,e,n){var r=ce.getSpanContext(t);if(r&&!ye(t)&&jt(r)){var o="00-"+r.traceId+"-"+r.spanId+"-0"+Number(r.traceFlags||yt.NONE).toString(16);n.set(e,On,o),r.traceState&&n.set(e,wn,r.traceState.serialize())}},t.prototype.extract=function(t,e,n){var r=n.get(e,On);if(!r)return t;var o=Array.isArray(r)?r[0]:r;if("string"!=typeof o)return t;var i=Cn(o);if(!i)return t;i.isRemote=!0;var s=n.get(e,wn);if(s){var a=Array.isArray(s)?s.join(","):s;i.traceState=new bn("string"==typeof a?a:void 0)}return ce.setSpanContext(t,i)},t.prototype.fields=function(){return[On,wn]},t}(),In=gt("OpenTelemetry SDK Context Key RPC_METADATA");!function(t){t.HTTP="http"}(Rn||(Rn={}));var Pn,Mn,Ln=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Wt.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}(),Dn=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Wt.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}(),xn=function(){function t(t){var e,n,r,o;this._root=t.root,this._root||(Ue(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Dn),this._remoteParentSampled=null!==(e=t.remoteParentSampled)&&void 0!==e?e:new Dn,this._remoteParentNotSampled=null!==(n=t.remoteParentNotSampled)&&void 0!==n?n:new Ln,this._localParentSampled=null!==(r=t.localParentSampled)&&void 0!==r?r:new Dn,this._localParentNotSampled=null!==(o=t.localParentNotSampled)&&void 0!==o?o:new Ln}return t.prototype.shouldSample=function(t,e,n,r,o,i){var s=ce.getSpanContext(t);return s&&jt(s)?s.isRemote?s.traceFlags&yt.SAMPLED?this._remoteParentSampled.shouldSample(t,e,n,r,o,i):this._remoteParentNotSampled.shouldSample(t,e,n,r,o,i):s.traceFlags&yt.SAMPLED?this._localParentSampled.shouldSample(t,e,n,r,o,i):this._localParentNotSampled.shouldSample(t,e,n,r,o,i):this._root.shouldSample(t,e,n,r,o,i)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}(),kn=function(){function t(t){void 0===t&&(t=0),this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(4294967295*this._ratio)}return t.prototype.shouldSample=function(t,e){return{decision:Ht(e)&&this._accumulate(e)<this._upperBound?Wt.RECORD_AND_SAMPLED:Wt.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t},t.prototype._accumulate=function(t){for(var e=0,n=0;n<t.length/8;n++){var r=8*n;e=(e^parseInt(t.slice(r,r+8),16))>>>0}return e},t}(),Un="[object Null]",Bn="[object Undefined]",Hn=Function.prototype.toString,jn=Hn.call(Object),Vn=(Pn=Object.getPrototypeOf,Mn=Object,function(t){return Pn(Mn(t))}),Gn=Object.prototype,Fn=Gn.hasOwnProperty,Wn=Symbol?Symbol.toStringTag:void 0,$n=Gn.toString;function Xn(t){if(!function(t){return null!=t&&"object"==typeof t}(t)||"[object Object]"!==function(t){if(null==t)return void 0===t?Bn:Un;return Wn&&Wn in Object(t)?function(t){var e=Fn.call(t,Wn),n=t[Wn],r=!1;try{t[Wn]=void 0,r=!0}catch(t){}var o=$n.call(t);r&&(e?t[Wn]=n:delete t[Wn]);return o}(t):function(t){return $n.call(t)}(t)}(t))return!1;var e=Vn(t);if(null===e)return!0;var n=Fn.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Hn.call(n)===jn}function Kn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t.shift(),r=new WeakMap;t.length>0;)n=qn(n,t.shift(),0,r);return n}function Yn(t){return Jn(t)?t.slice():t}function qn(t,e,n,r){var o;if(void 0===n&&(n=0),!(n>20)){if(n++,tr(t)||tr(e)||Qn(e))o=Yn(e);else if(Jn(t)){if(o=t.slice(),Jn(e))for(var i=0,s=e.length;i<s;i++)o.push(Yn(e[i]));else if(Zn(e))for(i=0,s=(a=Object.keys(e)).length;i<s;i++){o[c=a[i]]=Yn(e[c])}}else if(Zn(t))if(Zn(e)){if(!function(t,e){if(!Xn(t)||!Xn(e))return!1;return!0}(t,e))return e;o=Object.assign({},t);var a;for(i=0,s=(a=Object.keys(e)).length;i<s;i++){var c,u=e[c=a[i]];if(tr(u))void 0===u?delete o[c]:o[c]=u;else{var l=o[c],p=u;if(zn(t,c,r)||zn(e,c,r))delete o[c];else{if(Zn(l)&&Zn(p)){var h=r.get(l)||[],_=r.get(p)||[];h.push({obj:t,key:c}),_.push({obj:e,key:c}),r.set(l,h),r.set(p,_)}o[c]=qn(o[c],u,n,r)}}}}else o=e;return o}}function zn(t,e,n){for(var r=n.get(t[e])||[],o=0,i=r.length;o<i;o++){var s=r[o];if(s.key===e&&s.obj===t)return!0}return!1}function Jn(t){return Array.isArray(t)}function Qn(t){return"function"==typeof t}function Zn(t){return!tr(t)&&!Jn(t)&&!Qn(t)&&"object"==typeof t}function tr(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}var er=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function nr(t,e){return"string"==typeof e?t===e:!!t.match(e)}var rr=function(){function t(){var t=this;this._promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),t.prototype.resolve=function(t){this._resolve(t)},t.prototype.reject=function(t){this._reject(t)},t}(),or=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ir=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},sr=function(){function t(t,e){this._callback=t,this._that=e,this._isCalled=!1,this._deferred=new rr}return Object.defineProperty(t.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),t.prototype.call=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((t=this._callback).call.apply(t,ir([this._that],or(n),!1))).then((function(t){return e._deferred.resolve(t)}),(function(t){return e._deferred.reject(t)}))}catch(t){this._deferred.reject(t)}}return this._deferred.promise},t}(),ar=Object.freeze({__proto__:null,baggageUtils:Ae,W3CBaggagePropagator:Ce,sanitizeAttributes:Ie,isAttributeKey:Pe,isAttributeValue:Me,setGlobalErrorHandler:function(t){ke=t},globalErrorHandler:Ue,loggingErrorHandler:De,hrTime:pn,timeInputToHrTime:hn,hrTimeDuration:_n,hrTimeToTimeStamp:function(t){var e=""+"0".repeat(9)+t[1]+"Z",n=e.substr(e.length-9-1);return new Date(1e3*t[0]).toISOString().replace("000Z",n)},hrTimeToNanoseconds:fn,hrTimeToMilliseconds:function(t){return Math.round(1e3*t[0]+t[1]/1e6)},hrTimeToMicroseconds:dn,isTimeInputHrTime:En,isTimeInput:gn,get ExportResultCode(){return an},VERSION:rn,getEnv:ze,_globalThis:qe,hexToBase64:Je,RandomIdGenerator:Qe,otperformance:nn,SDK_INFO:on,unrefTimer:sn,CompositePropagator:mn,TRACE_PARENT_HEADER:On,TRACE_STATE_HEADER:wn,parseTraceParent:Cn,W3CTraceContextPropagator:Nn,get RPCType(){return Rn},setRPCMetadata:function(t,e){return t.setValue(In,e)},deleteRPCMetadata:function(t){return t.deleteValue(In)},getRPCMetadata:function(t){return t.getValue(In)},AlwaysOffSampler:Ln,AlwaysOnSampler:Dn,ParentBasedSampler:xn,TraceIdRatioBasedSampler:kn,suppressTracing:ge,unsuppressTracing:function(t){return t.deleteValue(Ee)},isTracingSuppressed:ye,TraceState:bn,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:Ge,DEFAULT_ATTRIBUTE_COUNT_LIMIT:128,DEFAULT_ENVIRONMENT:Fe,parseEnvironment:Ye,merge:Kn,get TracesSamplerValues(){return xe},urlMatches:nr,isUrlIgnored:function(t,e){var n,r;if(!e)return!1;try{for(var o=er(e),i=o.next();!i.done;i=o.next()){if(nr(t,i.value))return!0}}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},isWrapped:function(t){return"function"==typeof t&&"function"==typeof t.__original&&"function"==typeof t.__unwrap&&!0===t.__wrapped},BindOnceFuture:sr});function cr(){return"unknown_service"}var ur=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},lr=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},pr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},hr=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},_r=new(function(){function t(){}return t.prototype.detect=function(){return pr(this,void 0,void 0,(function(){return hr(this,(function(t){return[2,new Er({})]}))}))},t}()),fr=_r,dr=_r,Er=function(){function t(t){this.attributes=t}return t.empty=function(){return t.EMPTY},t.default=function(){var e;return new t(((e={})[_e.SERVICE_NAME]="unknown_service",e[_e.TELEMETRY_SDK_LANGUAGE]=on[_e.TELEMETRY_SDK_LANGUAGE],e[_e.TELEMETRY_SDK_NAME]=on[_e.TELEMETRY_SDK_NAME],e[_e.TELEMETRY_SDK_VERSION]=on[_e.TELEMETRY_SDK_VERSION],e))},t.prototype.merge=function(e){return e&&Object.keys(e.attributes).length?new t(Object.assign({},this.attributes,e.attributes)):this},t.EMPTY=new t({}),t}(),gr=function(){return gr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},gr.apply(this,arguments)},yr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},mr=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Sr=function(){function t(){}return t.prototype.detect=function(t){return yr(this,void 0,void 0,(function(){var e,n;return mr(this,(function(r){return"undefined"!=typeof navigator?((n={})[_e.PROCESS_RUNTIME_NAME]="browser",n[_e.PROCESS_RUNTIME_DESCRIPTION]="Web Browser",n[_e.PROCESS_RUNTIME_VERSION]=navigator.userAgent,e=n,[2,this._getResourceAttributes(e,t)]):[2,Er.empty()]}))}))},t.prototype._getResourceAttributes=function(t,e){return""===t[_e.PROCESS_RUNTIME_VERSION]?(le.debug("BrowserDetector failed: Unable to find required browser resources. "),Er.empty()):new Er(gr({},t))},t}(),vr=new Sr,Tr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},br=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Or=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wr=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ar=function(){function t(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}return t.prototype.detect=function(t){return Tr(this,void 0,void 0,(function(){var t,e,n,r,o;return br(this,(function(i){if(t={},e=ze(),n=e.OTEL_RESOURCE_ATTRIBUTES,r=e.OTEL_SERVICE_NAME,n)try{o=this._parseResourceAttributes(n),Object.assign(t,o)}catch(t){le.debug("EnvDetector failed: "+t.message)}return r&&(t[_e.SERVICE_NAME]=r),[2,new Er(t)]}))}))},t.prototype._parseResourceAttributes=function(t){var e,n;if(!t)return{};var r={},o=t.split(this._COMMA_SEPARATOR,-1);try{for(var i=Or(o),s=i.next();!s.done;s=i.next()){var a=s.value.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(2===a.length){var c=wr(a,2),u=c[0],l=c[1];if(u=u.trim(),l=l.trim().split('^"|"$').join(""),!this._isValidAndNotEmpty(u))throw new Error("Attribute key "+this._ERROR_MESSAGE_INVALID_CHARS);if(!this._isValid(l))throw new Error("Attribute value "+this._ERROR_MESSAGE_INVALID_VALUE);r[u]=l}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},t.prototype._isValid=function(t){return t.length<=this._MAX_LENGTH&&this._isPrintableString(t)},t.prototype._isPrintableString=function(t){for(var e=0;e<t.length;e++){var n=t.charAt(e);if(n<=" "||n>="~")return!1}return!0},t.prototype._isValidAndNotEmpty=function(t){return t.length>0&&this._isValid(t)},t}(),Cr=new Ar,Rr=function(){return Rr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Rr.apply(this,arguments)},Nr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},Ir=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Pr=function(){function t(){}return t.prototype.detect=function(t){return Nr(this,void 0,void 0,(function(){var e,n;return Ir(this,(function(r){return"object"!=typeof process?[2,Er.empty()]:((n={})[_e.PROCESS_PID]=process.pid,n[_e.PROCESS_EXECUTABLE_NAME]=process.title||"",n[_e.PROCESS_COMMAND]=process.argv[1]||"",n[_e.PROCESS_COMMAND_LINE]=process.argv.join(" ")||"",n[_e.PROCESS_RUNTIME_VERSION]=process.versions.node,n[_e.PROCESS_RUNTIME_NAME]="nodejs",n[_e.PROCESS_RUNTIME_DESCRIPTION]="Node.js",e=n,[2,this._getResourceAttributes(e,t)])}))}))},t.prototype._getResourceAttributes=function(t,e){return""===t[_e.PROCESS_EXECUTABLE_NAME]||""===t[_e.PROCESS_EXECUTABLE_PATH]||""===t[_e.PROCESS_COMMAND]||""===t[_e.PROCESS_COMMAND_LINE]||""===t[_e.PROCESS_RUNTIME_VERSION]?(le.debug("ProcessDetector failed: Unable to find required process resources. "),Er.empty()):new Er(Rr({},t))},t}(),Mr=new Pr,Lr=Object.freeze({__proto__:null,Resource:Er,defaultServiceName:cr,detectResources:function(t){return void 0===t&&(t={}),ur(void 0,void 0,void 0,(function(){var e;return lr(this,(function(n){switch(n.label){case 0:return e=Object.assign(t),[4,Promise.all((e.detectors||[]).map((function(t){return ur(void 0,void 0,void 0,(function(){var n,r;return lr(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.detect(e)];case 1:return n=o.sent(),le.debug(t.constructor.name+" found resource.",n),[2,n];case 2:return r=o.sent(),le.debug(t.constructor.name+" failed: "+r.message),[2,Er.empty()];case 3:return[2]}}))}))})))];case 1:return[2,n.sent().reduce((function(t,e){return t.merge(e)}),Er.empty())]}}))}))},hostDetector:fr,osDetector:dr,browserDetector:vr,envDetector:Cr,processDetector:Mr}),Dr=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xr=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},kr=function(){function t(t,e,n,r,o,i,s,a){void 0===s&&(s=[]),void 0===a&&(a=pn()),this.attributes={},this.links=[],this.events=[],this.status={code:Xt.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=r,this.parentSpanId=i,this.kind=o,this.links=s,this.startTime=hn(a),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this._spanLimits=t.getSpanLimits(),this._spanProcessor=t.getActiveSpanProcessor(),this._spanProcessor.onStart(this,e),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return null==e||this._isSpanEnded()?this:0===t.length?(le.warn("Invalid attribute key: "+t),this):Me(e)?(Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)||(this.attributes[t]=this._truncateToSize(e)),this):(le.warn("Invalid attribute value set for key: "+t),this)},t.prototype.setAttributes=function(t){var e,n;try{for(var r=Dr(Object.entries(t)),o=r.next();!o.done;o=r.next()){var i=xr(o.value,2),s=i[0],a=i[1];this.setAttribute(s,a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return this},t.prototype.addEvent=function(t,e,n){if(this._isSpanEnded())return this;if(0===this._spanLimits.eventCountLimit)return le.warn("No events allowed."),this;this.events.length>=this._spanLimits.eventCountLimit&&(le.warn("Dropping extra events."),this.events.shift()),gn(e)&&(void 0===n&&(n=e),e=void 0),void 0===n&&(n=pn());var r=Ie(e);return this.events.push({name:t,attributes:r,time:hn(n)}),this},t.prototype.setStatus=function(t){return this._isSpanEnded()||(this.status=t),this},t.prototype.updateName=function(t){return this._isSpanEnded()||(this.name=t),this},t.prototype.end=function(t){void 0===t&&(t=pn()),this._isSpanEnded()?le.error("You can only call end() on a span once."):(this._ended=!0,this.endTime=hn(t),this._duration=_n(this.startTime,this.endTime),this._duration[0]<0&&le.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this))},t.prototype.isRecording=function(){return!1===this._ended},t.prototype.recordException=function(t,e){void 0===e&&(e=pn());var n={};"string"==typeof t?n[he.EXCEPTION_MESSAGE]=t:t&&(t.code?n[he.EXCEPTION_TYPE]=t.code.toString():t.name&&(n[he.EXCEPTION_TYPE]=t.name),t.message&&(n[he.EXCEPTION_MESSAGE]=t.message),t.stack&&(n[he.EXCEPTION_STACKTRACE]=t.stack)),n[he.EXCEPTION_TYPE]||n[he.EXCEPTION_MESSAGE]?this.addEvent("exception",n,e):le.warn("Failed to record an exception "+t)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),t.prototype._isSpanEnded=function(){return this._ended&&le.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},t.prototype._truncateToLimitUtil=function(t,e){return t.length<=e?t:t.substr(0,e)},t.prototype._truncateToSize=function(t){var e=this,n=this._attributeValueLengthLimit;return n<=0?(le.warn("Attribute value limit must be positive, got "+n),t):"string"==typeof t?this._truncateToLimitUtil(t,n):Array.isArray(t)?t.map((function(t){return"string"==typeof t?e._truncateToLimitUtil(t,n):t})):t},t}(),Ur=ze(),Br=xe.AlwaysOn,Hr={sampler:jr(Ur),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:ze().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:ze().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:ze().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:ze().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:ze().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:ze().OTEL_SPAN_EVENT_COUNT_LIMIT}};function jr(t){switch(void 0===t&&(t=ze()),t.OTEL_TRACES_SAMPLER){case xe.AlwaysOn:return new Dn;case xe.AlwaysOff:return new Ln;case xe.ParentBasedAlwaysOn:return new xn({root:new Dn});case xe.ParentBasedAlwaysOff:return new xn({root:new Ln});case xe.TraceIdRatio:return new kn(Vr(t));case xe.ParentBasedTraceIdRatio:return new xn({root:new kn(Vr(t))});default:return le.error('OTEL_TRACES_SAMPLER value "'+t.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+Br+'".'),new Dn}}function Vr(t){if(void 0===t.OTEL_TRACES_SAMPLER_ARG||""===t.OTEL_TRACES_SAMPLER_ARG)return le.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1;var e=Number(t.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(le.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to 1."),1):e<0||e>1?(le.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to 1."),1):e}var Gr,Fr,Wr=function(){function t(t,e,n){this._tracerProvider=n;var r,o,i,s=(r=e,o={sampler:jr()},(i=Object.assign({},Hr,o,r)).generalLimits=Object.assign({},Hr.generalLimits,r.generalLimits||{}),i.spanLimits=Object.assign({},Hr.spanLimits,r.spanLimits||{}),i);this._sampler=s.sampler,this._generalLimits=s.generalLimits,this._spanLimits=s.spanLimits,this._idGenerator=e.idGenerator||new Qe,this.resource=n.resource,this.instrumentationLibrary=t}return t.prototype.startSpan=function(t,e,n){var r,o;if(void 0===e&&(e={}),void 0===n&&(n=ae.active()),ye(n))return le.debug("Instrumentation suppressed, returning Noop Span"),ce.wrapSpanContext(Nt);e.root&&(n=ce.deleteSpan(n));var i,s,a,c=ce.getSpanContext(n),u=this._idGenerator.generateSpanId();c&&ce.isSpanContextValid(c)?(i=c.traceId,s=c.traceState,a=c.spanId):i=this._idGenerator.generateTraceId();var l=null!==(r=e.kind)&&void 0!==r?r:$t.INTERNAL,p=(null!==(o=e.links)&&void 0!==o?o:[]).map((function(t){return{context:t.context,attributes:Ie(t.attributes)}})),h=Ie(e.attributes),_=this._sampler.shouldSample(n,i,t,l,h,p),f={traceId:i,spanId:u,traceFlags:_.decision===Wt.RECORD_AND_SAMPLED?yt.SAMPLED:yt.NONE,traceState:s};if(_.decision===Wt.NOT_RECORD)return le.debug("Recording is off, propagating context in a non-recording span"),ce.wrapSpanContext(f);var d=new kr(this,n,t,f,l,a,p,e.startTime),E=Ie(Object.assign(h,_.attributes));return d.setAttributes(E),d},t.prototype.startActiveSpan=function(t,e,n,r){var o,i,s;if(!(arguments.length<2)){2===arguments.length?s=e:3===arguments.length?(o=e,s=n):(o=e,i=n,s=r);var a=null!=i?i:ae.active(),c=this.startSpan(t,o,a),u=ce.setSpan(a,c);return ae.with(u,s,void 0,c)}},t.prototype.getGeneralLimits=function(){return this._generalLimits},t.prototype.getSpanLimits=function(){return this._spanLimits},t.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},t}(),$r=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Xr=function(){function t(t){this._spanProcessors=t}return t.prototype.forceFlush=function(){var t,e,n=[];try{for(var r=$r(this._spanProcessors),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.forceFlush())}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return new Promise((function(t){Promise.all(n).then((function(){t()})).catch((function(e){Ue(e||new Error("MultiSpanProcessor: forceFlush failed")),t()}))}))},t.prototype.onStart=function(t,e){var n,r;try{for(var o=$r(this._spanProcessors),i=o.next();!i.done;i=o.next()){i.value.onStart(t,e)}}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.onEnd=function(t){var e,n;try{for(var r=$r(this._spanProcessors),o=r.next();!o.done;o=r.next()){o.value.onEnd(t)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.shutdown=function(){var t,e,n=[];try{for(var r=$r(this._spanProcessors),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.shutdown())}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return new Promise((function(t,e){Promise.all(n).then((function(){t()}),e)}))},t}(),Kr=function(){function t(){}return t.prototype.onStart=function(t,e){},t.prototype.onEnd=function(t){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve()},t}(),Yr=function(){function t(t,e){this._exporter=t,this._finishedSpans=[];var n=ze();this._maxExportBatchSize="number"==typeof(null==e?void 0:e.maxExportBatchSize)?e.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"==typeof(null==e?void 0:e.maxQueueSize)?e.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"==typeof(null==e?void 0:e.scheduledDelayMillis)?e.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"==typeof(null==e?void 0:e.exportTimeoutMillis)?e.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new sr(this._shutdown,this)}return t.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},t.prototype.onStart=function(t,e){},t.prototype.onEnd=function(t){this._shutdownOnce.isCalled||0!=(t.spanContext().traceFlags&yt.SAMPLED)&&this._addToBuffer(t)},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){var t=this;return Promise.resolve().then((function(){return t.onShutdown()})).then((function(){return t._flushAll()})).then((function(){return t._exporter.shutdown()}))},t.prototype._addToBuffer=function(t){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(t),this._maybeStartTimer())},t.prototype._flushAll=function(){var t=this;return new Promise((function(e,n){for(var r=[],o=0,i=Math.ceil(t._finishedSpans.length/t._maxExportBatchSize);o<i;o++)r.push(t._flushOneBatch());Promise.all(r).then((function(){e()})).catch(n)}))},t.prototype._flushOneBatch=function(){var t=this;return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((function(e,n){var r=setTimeout((function(){n(new Error("Timeout"))}),t._exportTimeoutMillis);ae.with(ge(ae.active()),(function(){t._exporter.export(t._finishedSpans.splice(0,t._maxExportBatchSize),(function(t){var o;clearTimeout(r),t.code===an.SUCCESS?e():n(null!==(o=t.error)&&void 0!==o?o:new Error("BatchSpanProcessor: span export failed"))}))}))}))},t.prototype._maybeStartTimer=function(){var t=this;void 0===this._timer&&(this._timer=setTimeout((function(){t._flushOneBatch().then((function(){t._finishedSpans.length>0&&(t._clearTimer(),t._maybeStartTimer())})).catch((function(t){Ue(t)}))}),this._scheduledDelayMillis),this._timer)},t.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},t}(),qr=(Gr=function(t,e){return Gr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},Gr(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Gr(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),zr=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.onInit(n),r}return qr(e,t),e.prototype.onInit=function(t){var e=this;!0!==(null==t?void 0:t.disableAutoFlushOnDocumentHide)&&"undefined"!=typeof document&&(this._visibilityChangeListener=function(){"hidden"===document.visibilityState&&e.forceFlush()},this._pageHideListener=function(){e.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},e.prototype.onShutdown=function(){"undefined"!=typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},e}(Yr);!function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"}(Fr||(Fr={}));var Jr,Qr,Zr=function(){function t(t){var e;void 0===t&&(t={}),this._registeredSpanProcessors=[],this._tracers=new Map;var n=Kn({},Hr,function(t){var e,n,r=Object.assign({},t.spanLimits);return null==r.attributeCountLimit&&null!=(null===(e=t.generalLimits)||void 0===e?void 0:e.attributeCountLimit)&&(r.attributeCountLimit=t.generalLimits.attributeCountLimit),null==r.attributeValueLengthLimit&&null!=(null===(n=t.generalLimits)||void 0===n?void 0:n.attributeValueLengthLimit)&&(r.attributeValueLengthLimit=t.generalLimits.attributeValueLengthLimit),Object.assign({},t,{spanLimits:r})}(t));this.resource=null!==(e=n.resource)&&void 0!==e?e:Er.empty(),this.resource=Er.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var r=this._buildExporterFromEnv();if(void 0!==r){var o=new zr(r);this.activeSpanProcessor=o}else this.activeSpanProcessor=new Kr}return t.prototype.getTracer=function(t,e,n){var r=t+"@"+(e||"")+":"+((null==n?void 0:n.schemaUrl)||"");return this._tracers.has(r)||this._tracers.set(r,new Wr({name:t,version:e,schemaUrl:null==n?void 0:n.schemaUrl},this._config,this)),this._tracers.get(r)},t.prototype.addSpanProcessor=function(t){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((function(t){return le.error("Error while trying to shutdown current span processor",t)})),this._registeredSpanProcessors.push(t),this.activeSpanProcessor=new Xr(this._registeredSpanProcessors)},t.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},t.prototype.register=function(t){void 0===t&&(t={}),ce.setGlobalTracerProvider(this),void 0===t.propagator&&(t.propagator=this._buildPropagatorFromEnv()),t.contextManager&&ae.setGlobalContextManager(t.contextManager),t.propagator&&ue.setGlobalPropagator(t.propagator)},t.prototype.forceFlush=function(){var t=this._config.forceFlushTimeoutMillis,e=this._registeredSpanProcessors.map((function(e){return new Promise((function(n){var r,o=setTimeout((function(){n(new Error("Span processor did not completed within timeout period of "+t+" ms")),r=Fr.timeout}),t);e.forceFlush().then((function(){clearTimeout(o),r!==Fr.timeout&&(r=Fr.resolved,n(r))})).catch((function(t){clearTimeout(o),r=Fr.error,n(t)}))}))}));return new Promise((function(t,n){Promise.all(e).then((function(e){var r=e.filter((function(t){return t!==Fr.resolved}));r.length>0?n(r):t()})).catch((function(t){return n([t])}))}))},t.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},t.prototype._getPropagator=function(t){var e;return null===(e=this.constructor._registeredPropagators.get(t))||void 0===e?void 0:e()},t.prototype._getSpanExporter=function(t){var e;return null===(e=this.constructor._registeredExporters.get(t))||void 0===e?void 0:e()},t.prototype._buildPropagatorFromEnv=function(){var t=this,e=Array.from(new Set(ze().OTEL_PROPAGATORS)),n=e.map((function(e){var n=t._getPropagator(e);return n||le.warn('Propagator "'+e+'" requested through environment variable is unavailable.'),n})).reduce((function(t,e){return e&&t.push(e),t}),[]);return 0===n.length?void 0:1===e.length?n[0]:new mn({propagators:n})},t.prototype._buildExporterFromEnv=function(){var t=ze().OTEL_TRACES_EXPORTER;if("none"!==t){var e=this._getSpanExporter(t);return e||le.error('Exporter "'+t+'" requested through environment variable is unavailable.'),e}},t._registeredPropagators=new Map([["tracecontext",function(){return new Nn}],["baggage",function(){return new Ce}]]),t._registeredExporters=new Map,t}(),to=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},eo=function(){function t(){}return t.prototype.export=function(t,e){return this._sendSpans(t,e)},t.prototype.shutdown=function(){return this._sendSpans([]),Promise.resolve()},t.prototype._exportInfo=function(t){return{traceId:t.spanContext().traceId,parentId:t.parentSpanId,name:t.name,id:t.spanContext().spanId,kind:t.kind,timestamp:dn(t.startTime),duration:dn(t.duration),attributes:t.attributes,status:t.status,events:t.events,links:t.links}},t.prototype._sendSpans=function(t,e){var n,r;try{for(var o=to(t),i=o.next();!i.done;i=o.next()){var s=i.value;console.dir(this._exportInfo(s),{depth:3})}}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}if(e)return e({code:an.SUCCESS})},t}(),no=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ro=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},oo=function(){function t(){this._finishedSpans=[],this._stopped=!1}return t.prototype.export=function(t,e){var n;if(this._stopped)return e({code:an.FAILED,error:new Error("Exporter has been stopped")});(n=this._finishedSpans).push.apply(n,ro([],no(t),!1)),setTimeout((function(){return e({code:an.SUCCESS})}),0)},t.prototype.shutdown=function(){return this._stopped=!0,this._finishedSpans=[],Promise.resolve()},t.prototype.reset=function(){this._finishedSpans=[]},t.prototype.getFinishedSpans=function(){return this._finishedSpans},t}(),io=function(){function t(t){this._exporter=t,this._shutdownOnce=new sr(this._shutdown,this)}return t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.onStart=function(t,e){},t.prototype.onEnd=function(t){var e=this;this._shutdownOnce.isCalled||0!=(t.spanContext().traceFlags&yt.SAMPLED)&&ae.with(ge(ae.active()),(function(){e._exporter.export([t],(function(t){var e;t.code!==an.SUCCESS&&Ue(null!==(e=t.error)&&void 0!==e?e:new Error("SimpleSpanProcessor: span export failed (status "+t+")"))}))}))},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){return this._exporter.shutdown()},t}(),so=Object.freeze({__proto__:null,Tracer:Wr,get ForceFlushState(){return Fr},BasicTracerProvider:Zr,BatchSpanProcessor:zr,ConsoleSpanExporter:eo,InMemorySpanExporter:oo,SimpleSpanProcessor:io,NoopSpanProcessor:Kr,Span:kr}),ao=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},co=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))},uo=function(){function t(){this._enabled=!1,this._currentContext=St}return t.prototype._bindFunction=function(t,e){void 0===t&&(t=St);var n=this,r=function(){for(var r=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return n.with(t,(function(){return e.apply(r,o)}))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),r},t.prototype.active=function(){return this._currentContext},t.prototype.bind=function(t,e){return void 0===t&&(t=this.active()),"function"==typeof e?this._bindFunction(t,e):e},t.prototype.disable=function(){return this._currentContext=St,this._enabled=!1,this},t.prototype.enable=function(){return this._enabled||(this._enabled=!0,this._currentContext=St),this},t.prototype.with=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i=this._currentContext;this._currentContext=t||St;try{return e.call.apply(e,co([n],ao(r),!1))}finally{this._currentContext=i}},t}(),lo=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),po=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this;if(e.contextManager)throw"contextManager should be defined in register method not in constructor";if(e.propagator)throw"propagator should be defined in register method not in constructor";return n}return lo(e,t),e.prototype.register=function(e){void 0===e&&(e={}),void 0===e.contextManager&&(e.contextManager=new uo),e.contextManager&&e.contextManager.enable(),t.prototype.register.call(this,e)},e}(Zr);function ho(t,e){return e in t}function _o(t,e,n){if(ho(n,e)&&"number"==typeof n[e])return t.addEvent(e,n[e]),t}function fo(t){return t.slice().sort((function(t,e){var n=t[Jr.FETCH_START],r=e[Jr.FETCH_START];return n>r?1:n<r?-1:0}))}function Eo(t){if("function"==typeof URL)return new URL(t,location.href);var e=(Qr||(Qr=document.createElement("a")),Qr);return e.href=t,e}!function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"}(Jr||(Jr={}));var go=Object.freeze({__proto__:null,WebTracerProvider:po,StackContextManager:uo,get PerformanceTimingNames(){return Jr},hasKey:ho,addSpanNetworkEvent:_o,addSpanNetworkEvents:function(t,e){_o(t,Jr.FETCH_START,e),_o(t,Jr.DOMAIN_LOOKUP_START,e),_o(t,Jr.DOMAIN_LOOKUP_END,e),_o(t,Jr.CONNECT_START,e),_o(t,Jr.SECURE_CONNECTION_START,e),_o(t,Jr.CONNECT_END,e),_o(t,Jr.REQUEST_START,e),_o(t,Jr.RESPONSE_START,e),_o(t,Jr.RESPONSE_END,e);var n=e[Jr.ENCODED_BODY_SIZE];void 0!==n&&t.setAttribute(he.HTTP_RESPONSE_CONTENT_LENGTH,n);var r=e[Jr.DECODED_BODY_SIZE];void 0!==r&&n!==r&&t.setAttribute(he.HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED,r)},sortResources:fo,getResource:function(t,e,n,r,o,i){void 0===o&&(o=new WeakSet);var s=Eo(t),a=function(t,e,n,r,o,i){var s=fn(e),a=fn(n),c=r.filter((function(e){var n=fn(hn(e[Jr.FETCH_START])),r=fn(hn(e[Jr.RESPONSE_END]));return e.initiatorType.toLowerCase()===(i||"xmlhttprequest")&&e.name===t&&n>=s&&r<=a}));c.length>0&&(c=c.filter((function(t){return!o.has(t)})));return c}(t=s.toString(),e,n,r,o,i);if(0===a.length)return{mainRequest:void 0};if(1===a.length)return{mainRequest:a[0]};var c=fo(a);if(s.origin!==location.origin&&c.length>1){var u=c[0],l=function(t,e,n){for(var r,o=fn(n),i=fn(hn(e)),s=t[1],a=t.length,c=1;c<a;c++){var u=t[c],l=fn(hn(u[Jr.FETCH_START])),p=o-fn(hn(u[Jr.RESPONSE_END]));l>=i&&(!r||p<r)&&(r=p,s=u)}return s}(c,u[Jr.RESPONSE_END],n),p=u[Jr.RESPONSE_END];return l[Jr.FETCH_START]<p&&(l=u,u=void 0),{corsPreFlightRequest:u,mainRequest:l}}return{mainRequest:a[0]}},parseUrl:Eo,normalizeUrl:function(t){return Eo(t).href},getElementXPath:function t(e,n){if(e.nodeType===Node.DOCUMENT_NODE)return"/";var r=function(t,e){var n=t.nodeType,r=function(t){if(!t.parentNode)return 0;var e=[t.nodeType];t.nodeType===Node.CDATA_SECTION_NODE&&e.push(Node.TEXT_NODE);var n=Array.from(t.parentNode.childNodes);if((n=n.filter((function(n){var r=n.localName;return e.indexOf(n.nodeType)>=0&&r===t.localName}))).length>=1)return n.indexOf(t)+1;return 0}(t),o="";if(n===Node.ELEMENT_NODE){var i=t.getAttribute("id");if(e&&i)return'//*[@id="'+i+'"]';o=t.localName}else if(n===Node.TEXT_NODE||n===Node.CDATA_SECTION_NODE)o="text()";else{if(n!==Node.COMMENT_NODE)return"";o="comment()"}if(o&&r>1)return"/"+o+"["+r+"]";return"/"+o}(e,n);if(n&&r.indexOf("@id")>0)return r;var o="";return e.parentNode&&(o+=t(e.parentNode,!1)),o+=r},shouldPropagateTraceHeaders:function(t,e){var n=e||[];return("string"==typeof n||n instanceof RegExp)&&(n=[n]),Eo(t).origin===location.origin||n.some((function(e){return nr(t,e)}))}}),yo=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},mo=1e4;function So(t){return"number"==typeof t?t<=0?vo(t,1e4):t:function(){var t,e=Number(null!==(t=ze().OTEL_EXPORTER_OTLP_TRACES_TIMEOUT)&&void 0!==t?t:ze().OTEL_EXPORTER_OTLP_TIMEOUT);return e<=0?vo(e,mo):e}()}function vo(t,e){return le.warn("Timeout must be greater than 0",t),e}var To=function(){function t(t){void 0===t&&(t={}),this._sendingPromises=[],this.url=this.getDefaultUrl(t),"string"==typeof t.hostname&&(this.hostname=t.hostname),this.shutdown=this.shutdown.bind(this),this._shutdownOnce=new sr(this._shutdown,this),this._concurrencyLimit="number"==typeof t.concurrencyLimit?t.concurrencyLimit:1/0,this.timeoutMillis=So(t.timeoutMillis),this.onInit(t)}return t.prototype.export=function(t,e){this._shutdownOnce.isCalled?e({code:an.FAILED,error:new Error("Exporter has been shutdown")}):this._sendingPromises.length>=this._concurrencyLimit?e({code:an.FAILED,error:new Error("Concurrent export limit reached")}):this._export(t).then((function(){e({code:an.SUCCESS})})).catch((function(t){e({code:an.FAILED,error:t})}))},t.prototype._export=function(t){var e=this;return new Promise((function(n,r){try{le.debug("items to be sent",t),e.send(t,n,r)}catch(t){r(t)}}))},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){return le.debug("shutdown started"),this.onShutdown(),Promise.all(this._sendingPromises).then((function(){}))},t}(),bo=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oo=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.name="OTLPExporterError",o.data=r,o.code=n,o}return bo(e,t),e}(Error),wo=function(){return wo=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},wo.apply(this,arguments)},Ao=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};var Co,Ro=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),No=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this;return n._useXHR=!1,n._useXHR=!!e.headers||"function"!=typeof navigator.sendBeacon,n._useXHR?n._headers=Object.assign({},function(t){void 0===t&&(t={});var e={};return Object.entries(t).forEach((function(t){var n=yo(t,2),r=n[0],o=n[1];void 0!==o?e[r]=String(o):le.warn('Header "'+r+'" has wrong value and will be ignored')})),e}(e.headers),we(ze().OTEL_EXPORTER_OTLP_HEADERS)):n._headers={},n}return Ro(e,t),e.prototype.onInit=function(){window.addEventListener("unload",this.shutdown)},e.prototype.onShutdown=function(){window.removeEventListener("unload",this.shutdown)},e.prototype.send=function(t,e,n){var r=this;if(this._shutdownOnce.isCalled)le.debug("Shutdown already started. Cannot send objects");else{var o=this.convert(t),i=JSON.stringify(o),s=new Promise((function(t,e){r._useXHR?function(t,e,n,r,o,i){var s,a=setTimeout((function(){s=!0,c.abort()}),r),c=new XMLHttpRequest;c.open("POST",e),Object.entries(wo(wo({},{Accept:"application/json","Content-Type":"application/json"}),n)).forEach((function(t){var e=Ao(t,2),n=e[0],r=e[1];c.setRequestHeader(n,r)})),c.send(t),c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE)if(c.status>=200&&c.status<=299)clearTimeout(a),le.debug("xhr success",t),o();else if(s){var e=new Oo("Request Timeout",c.status);i(e)}else e=new Oo("Failed to export with XHR (status: "+c.status+")",c.status),clearTimeout(a),i(e)}}(i,r.url,r._headers,r.timeoutMillis,t,e):function(t,e,n,r,o){navigator.sendBeacon(e,new Blob([t],n))?(le.debug("sendBeacon - can send",t),r()):o(new Oo("sendBeacon - cannot send "+t))}(i,r.url,{type:"application/json"},t,e)})).then(e,n);this._sendingPromises.push(s);var a=function(){var t=r._sendingPromises.indexOf(s);r._sendingPromises.splice(t,1)};s.then(a,a)}},e}(To);!function(t){t[t.SPAN_KIND_UNSPECIFIED=0]="SPAN_KIND_UNSPECIFIED",t[t.SPAN_KIND_INTERNAL=1]="SPAN_KIND_INTERNAL",t[t.SPAN_KIND_SERVER=2]="SPAN_KIND_SERVER",t[t.SPAN_KIND_CLIENT=3]="SPAN_KIND_CLIENT",t[t.SPAN_KIND_PRODUCER=4]="SPAN_KIND_PRODUCER",t[t.SPAN_KIND_CONSUMER=5]="SPAN_KIND_CONSUMER"}(Co||(Co={}));var Io=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Po(t){return Object.keys(t).map((function(e){return Mo(e,t[e])}))}function Mo(t,e){return{key:t,value:Lo(e)}}function Lo(t){var e=typeof t;return"string"===e?{stringValue:t}:"number"===e?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:"boolean"===e?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(Lo)}}:"object"===e&&null!=t?{kvlistValue:{values:Object.entries(t).map((function(t){var e=Io(t,2);return Mo(e[0],e[1])}))}}:{}}function Do(t,e){var n=t.spanContext(),r=t.status,o=e?t.parentSpanId:null!=t.parentSpanId?Je(t.parentSpanId):void 0;return{traceId:e?n.traceId:Je(n.traceId),spanId:e?n.spanId:Je(n.spanId),parentSpanId:o,name:t.name,kind:null==t.kind?0:t.kind+1,startTimeUnixNano:fn(t.startTime),endTimeUnixNano:fn(t.endTime),attributes:Po(t.attributes),droppedAttributesCount:0,events:t.events.map(xo),droppedEventsCount:0,status:{code:r.code,message:r.message},links:t.links.map((function(t){return function(t,e){return{attributes:t.attributes?Po(t.attributes):[],spanId:e?t.context.spanId:Je(t.context.spanId),traceId:e?t.context.traceId:Je(t.context.traceId),droppedAttributesCount:0}}(t,e)})),droppedLinksCount:0}}function xo(t){return{attributes:t.attributes?Po(t.attributes):[],name:t.name,timeUnixNano:fn(t.time),droppedAttributesCount:0}}var ko=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Uo=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};function Bo(t,e){for(var n=function(t){var e,n,r=new Map;try{for(var o=ko(t),i=o.next();!i.done;i=o.next()){var s=i.value,a=r.get(s.resource);a||(a=new Map,r.set(s.resource,a));var c=s.instrumentationLibrary.name+"@"+(s.instrumentationLibrary.version||"")+":"+(s.instrumentationLibrary.schemaUrl||""),u=a.get(c);u||(u=[],a.set(c,u)),u.push(s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}(t),r=[],o=n.entries(),i=o.next();!i.done;){for(var s=Uo(i.value,2),a=s[0],c=[],u=s[1].values(),l=u.next();!l.done;){var p=l.value;if(p.length>0){var h=p[0].instrumentationLibrary,_=h.name,f=h.version,d=h.schemaUrl,E=p.map((function(t){return Do(t,e)}));c.push({scope:{name:_,version:f},spans:E,schemaUrl:d})}l=u.next()}var g={resource:{attributes:Po(a.attributes),droppedAttributesCount:0},scopeSpans:c,schemaUrl:void 0};r.push(g),i=o.next()}return r}var Ho,jo=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vo=function(){function t(){}return t.prototype.createHistogram=function(t,e){return Qo},t.prototype.createCounter=function(t,e){return Jo},t.prototype.createUpDownCounter=function(t,e){return Zo},t.prototype.createObservableGauge=function(t,e){return ei},t.prototype.createObservableCounter=function(t,e){return ti},t.prototype.createObservableUpDownCounter=function(t,e){return ni},t.prototype.addBatchObservableCallback=function(t,e){},t.prototype.removeBatchObservableCallback=function(t){},t}(),Go=function(){},Fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jo(e,t),e.prototype.add=function(t,e){},e}(Go),Wo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jo(e,t),e.prototype.add=function(t,e){},e}(Go),$o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jo(e,t),e.prototype.record=function(t,e){},e}(Go),Xo=function(){function t(){}return t.prototype.addCallback=function(t){},t.prototype.removeCallback=function(t){},t}(),Ko=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jo(e,t),e}(Xo),Yo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jo(e,t),e}(Xo),qo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return jo(e,t),e}(Xo),zo=new Vo,Jo=new Fo,Qo=new $o,Zo=new Wo,ti=new Ko,ei=new Yo,ni=new qo,ri=new(function(){function t(){}return t.prototype.getMeter=function(t,e,n){return zo},t}());!function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"}(Ho||(Ho={}));var oi="object"==typeof globalThis?globalThis:"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:{},ii=Symbol.for("io.opentelemetry.js.api.metrics"),si=oi;var ai,ci,ui=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(t){return si[ii]?this.getMeterProvider():(si[ii]=(e=4,n=t,r=ri,function(t){return t===e?n:r}),t);var e,n,r},t.prototype.getMeterProvider=function(){var t,e;return null!==(e=null===(t=si[ii])||void 0===t?void 0:t.call(si,4))&&void 0!==e?e:ri},t.prototype.getMeter=function(t,e,n){return this.getMeterProvider().getMeter(t,e,n)},t.prototype.disable=function(){delete si[ii]},t}();ui.getInstance(),function(t){t[t.DELTA=0]="DELTA",t[t.CUMULATIVE=1]="CUMULATIVE"}(ai||(ai={})),function(t){t[t.HISTOGRAM=0]="HISTOGRAM",t[t.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",t[t.GAUGE=2]="GAUGE",t[t.SUM=3]="SUM"}(ci||(ci={}));var li=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function pi(t){var e=Object.keys(t);return 0===e.length?"":(e=e.sort(),JSON.stringify(e.map((function(e){return[e,t[e]]}))))}var hi=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return li(e,t),e}(Error);function _i(t,e){var n,r=new Promise((function(t,r){n=setTimeout((function(){r(new hi("Operation timed out."))}),e)}));return Promise.race([t,r]).then((function(t){return clearTimeout(n),t}),(function(t){throw clearTimeout(n),t}))}var fi,di=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},Ei=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},gi=function(){function t(){this._shutdown=!1}return t.prototype.setMetricProducer=function(t){if(this._metricProducer)throw new Error("MetricReader can not be bound to a MeterProvider again.");this._metricProducer=t,this.onInitialized()},t.prototype.onInitialized=function(){},t.prototype.collect=function(t){return di(this,void 0,void 0,(function(){return Ei(this,(function(e){if(void 0===this._metricProducer)throw new Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw new Error("MetricReader is shutdown");return[2,this._metricProducer.collect({timeoutMillis:null==t?void 0:t.timeoutMillis})]}))}))},t.prototype.shutdown=function(t){return di(this,void 0,void 0,(function(){return Ei(this,(function(e){switch(e.label){case 0:return this._shutdown?(le.error("Cannot call shutdown twice."),[2]):null!=(null==t?void 0:t.timeoutMillis)?[3,2]:[4,this.onShutdown()];case 1:return e.sent(),[3,4];case 2:return[4,_i(this.onShutdown(),t.timeoutMillis)];case 3:e.sent(),e.label=4;case 4:return this._shutdown=!0,[2]}}))}))},t.prototype.forceFlush=function(t){return di(this,void 0,void 0,(function(){return Ei(this,(function(e){switch(e.label){case 0:return this._shutdown?(le.warn("Cannot forceFlush on already shutdown MetricReader."),[2]):null!=(null==t?void 0:t.timeoutMillis)?[3,2]:[4,this.onForceFlush()];case 1:case 3:return e.sent(),[2];case 2:return[4,_i(this.onForceFlush(),t.timeoutMillis)]}}))}))},t}(),yi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},Si=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},vi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Ti=function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};!function(t){function e(e){var n,r,o=t.call(this)||this;if(void 0!==e.exportIntervalMillis&&e.exportIntervalMillis<=0)throw Error("exportIntervalMillis must be greater than 0");if(void 0!==e.exportTimeoutMillis&&e.exportTimeoutMillis<=0)throw Error("exportTimeoutMillis must be greater than 0");if(void 0!==e.exportTimeoutMillis&&void 0!==e.exportIntervalMillis&&e.exportIntervalMillis<e.exportTimeoutMillis)throw Error("exportIntervalMillis must be greater than or equal to exportTimeoutMillis");return o._exportInterval=null!==(n=e.exportIntervalMillis)&&void 0!==n?n:6e4,o._exportTimeout=null!==(r=e.exportTimeoutMillis)&&void 0!==r?r:3e4,o._exporter=e.exporter,o}yi(e,t),e.prototype._runOnce=function(){return mi(this,void 0,void 0,(function(){var t,e,n,r,o=this;return Si(this,(function(i){switch(i.label){case 0:return[4,this.collect({})];case 1:return t=i.sent(),e=t.resourceMetrics,(n=t.errors).length>0&&(r=le).error.apply(r,Ti(["PeriodicExportingMetricReader: metrics collection errors"],vi(n),!1)),[2,new Promise((function(t,n){o._exporter.export(e,(function(e){var r;e.code!==an.SUCCESS?n(null!==(r=e.error)&&void 0!==r?r:new Error("PeriodicExportingMetricReader: metrics export failed (error "+e.error+")")):t()}))}))]}}))}))},e.prototype.onInitialized=function(){var t=this;this._interval=setInterval((function(){return mi(t,void 0,void 0,(function(){var t;return Si(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,_i(this._runOnce(),this._exportTimeout)];case 1:return e.sent(),[3,3];case 2:return(t=e.sent())instanceof hi?(le.error("Export took longer than %s milliseconds and timed out.",this._exportTimeout),[2]):(Ue(t),[3,3]);case 3:return[2]}}))}))}),this._exportInterval),this._interval},e.prototype.onForceFlush=function(){return mi(this,void 0,void 0,(function(){return Si(this,(function(t){switch(t.label){case 0:return[4,this._exporter.forceFlush()];case 1:return t.sent(),[2]}}))}))},e.prototype.onShutdown=function(){return mi(this,void 0,void 0,(function(){return Si(this,(function(t){switch(t.label){case 0:return this._interval&&clearInterval(this._interval),[4,this._exporter.shutdown()];case 1:return t.sent(),[2]}}))}))},e.prototype.selectAggregationTemporality=function(t){return this._exporter.selectAggregationTemporality(t)}}(gi),function(t){t.COUNTER="COUNTER",t.HISTOGRAM="HISTOGRAM",t.UP_DOWN_COUNTER="UP_DOWN_COUNTER",t.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",t.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",t.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"}(fi||(fi={}));var bi=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oi=function(){function t(t,e){this._writableMetricStorage=t,this._descriptor=e}return t.prototype._record=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n=ae.active()),this._descriptor.valueType!==Ho.INT||Number.isInteger(t)||(le.warn("INT value type cannot accept a floating-point value for "+this._descriptor.name+", ignoring the fractional digits."),t=Math.trunc(t)),this._writableMetricStorage.record(t,e,n,pn())},t}();!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}bi(e,t),e.prototype.add=function(t,e,n){this._record(t,e,n)}}(Oi),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}bi(e,t),e.prototype.add=function(t,e,n){t<0?le.warn("negative value provided to counter "+this._descriptor.name+": "+t):this._record(t,e,n)}}(Oi),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}bi(e,t),e.prototype.record=function(t,e,n){t<0?le.warn("negative value provided to histogram "+this._descriptor.name+": "+t):this._record(t,e,n)}}(Oi);var wi=function(){function t(t,e,n){this._observableRegistry=n,this._descriptor=t,this._metricStorages=e}return t.prototype.addCallback=function(t){this._observableRegistry.addCallback(t,this)},t.prototype.removeCallback=function(t){this._observableRegistry.removeCallback(t,this)},t}();!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}bi(e,t)}(wi),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}bi(e,t)}(wi),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}bi(e,t)}(wi);var Ai,Ci=/[\^$\\.+?()[\]{}|]/g,Ri=function(){function t(e){"*"===e?(this._matchAll=!0,this._regexp=/.*/):(this._matchAll=!1,this._regexp=new RegExp(t.escapePattern(e)))}return t.prototype.match=function(t){return!!this._matchAll||this._regexp.test(t)},t.escapePattern=function(t){return"^"+t.replace(Ci,"\\$&").replace("*",".*")+"$"},t.hasWildcard=function(t){return t.includes("*")},t}(),Ni=function(){function t(t){this._matchAll=void 0===t,this._pattern=t}return t.prototype.match=function(t){return!!this._matchAll||t===this._pattern},t}(),Ii=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pi=function(){function t(){}return t.Noop=function(){return Di},t}(),Mi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ii(e,t),e.prototype.process=function(t,e){return t},e}(Pi),Li=function(t){function e(e){var n=t.call(this)||this;return n._allowedAttributeNames=e,n}return Ii(e,t),e.prototype.process=function(t,e){var n=this,r={};return Object.keys(t).filter((function(t){return n._allowedAttributeNames.includes(t)})).forEach((function(e){return r[e]=t[e]})),r},e}(Pi),Di=new Mi,xi=function(){function t(t){var e;this._nameFilter=new Ri(null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"*"),this._type=null==t?void 0:t.type}return t.prototype.getType=function(){return this._type},t.prototype.getNameFilter=function(){return this._nameFilter},t}(),ki=function(){function t(t){this._nameFilter=new Ni(null==t?void 0:t.name),this._versionFilter=new Ni(null==t?void 0:t.version),this._schemaUrlFilter=new Ni(null==t?void 0:t.schemaUrl)}return t.prototype.getNameFilter=function(){return this._nameFilter},t.prototype.getVersionFilter=function(){return this._versionFilter},t.prototype.getSchemaUrlFilter=function(){return this._schemaUrlFilter},t}();!function(t){t[t.DROP=0]="DROP",t[t.SUM=1]="SUM",t[t.LAST_VALUE=2]="LAST_VALUE",t[t.HISTOGRAM=3]="HISTOGRAM"}(Ai||(Ai={}));var Ui=function(){function t(){this.kind=Ai.DROP}return t.prototype.createAccumulation=function(){},t.prototype.merge=function(t,e){},t.prototype.diff=function(t,e){},t.prototype.toMetricData=function(t,e,n,r){},t}(),Bi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};var Hi=function(){function t(t,e,n,r){var o,i;void 0===n&&(n=!0),void 0===r&&((i=(o=e).map((function(){return 0}))).push(0),r={buckets:{boundaries:o,counts:i},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}),this.startTime=t,this._boundaries=e,this._recordMinMax=n,this._current=r}return t.prototype.record=function(t){this._current.count+=1,this._current.sum+=t,this._recordMinMax&&(this._current.min=Math.min(t,this._current.min),this._current.max=Math.max(t,this._current.max),this._current.hasMinMax=!0);for(var e=0;e<this._boundaries.length;e++)if(t<this._boundaries[e])return void(this._current.buckets.counts[e]+=1);this._current.buckets.counts[this._boundaries.length]+=1},t.prototype.setStartTime=function(t){this.startTime=t},t.prototype.toPointValue=function(){return this._current},t}(),ji=function(){function t(t,e){this._boundaries=t,this._recordMinMax=e,this.kind=Ai.HISTOGRAM}return t.prototype.createAccumulation=function(t){return new Hi(t,this._boundaries,this._recordMinMax)},t.prototype.merge=function(t,e){for(var n=t.toPointValue(),r=e.toPointValue(),o=n.buckets.counts,i=r.buckets.counts,s=new Array(o.length),a=0;a<o.length;a++)s[a]=o[a]+i[a];var c=1/0,u=-1/0;return this._recordMinMax&&(n.hasMinMax&&r.hasMinMax?(c=Math.min(n.min,r.min),u=Math.max(n.max,r.max)):n.hasMinMax?(c=n.min,u=n.max):r.hasMinMax&&(c=r.min,u=r.max)),new Hi(t.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:s},count:n.count+r.count,sum:n.sum+r.sum,hasMinMax:this._recordMinMax&&(n.hasMinMax||r.hasMinMax),min:c,max:u})},t.prototype.diff=function(t,e){for(var n=t.toPointValue(),r=e.toPointValue(),o=n.buckets.counts,i=r.buckets.counts,s=new Array(o.length),a=0;a<o.length;a++)s[a]=i[a]-o[a];return new Hi(e.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:s},count:r.count-n.count,sum:r.sum-n.sum,hasMinMax:!1,min:1/0,max:-1/0})},t.prototype.toMetricData=function(t,e,n,r){return{descriptor:t,aggregationTemporality:e,dataPointType:ci.HISTOGRAM,dataPoints:n.map((function(e){var n=Bi(e,2),o=n[0],i=n[1],s=i.toPointValue(),a=t.type===fi.UP_DOWN_COUNTER||t.type===fi.OBSERVABLE_GAUGE||t.type===fi.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:o,startTime:i.startTime,endTime:r,value:{min:s.hasMinMax?s.min:void 0,max:s.hasMinMax?s.max:void 0,sum:a?void 0:s.sum,buckets:s.buckets,count:s.count}}}))}},t}(),Vi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},Gi=function(){function t(t,e,n){void 0===e&&(e=0),void 0===n&&(n=[0,0]),this.startTime=t,this._current=e,this.sampleTime=n}return t.prototype.record=function(t){this._current=t,this.sampleTime=pn()},t.prototype.setStartTime=function(t){this.startTime=t},t.prototype.toPointValue=function(){return this._current},t}(),Fi=function(){function t(){this.kind=Ai.LAST_VALUE}return t.prototype.createAccumulation=function(t){return new Gi(t)},t.prototype.merge=function(t,e){var n=dn(e.sampleTime)>=dn(t.sampleTime)?e:t;return new Gi(t.startTime,n.toPointValue(),n.sampleTime)},t.prototype.diff=function(t,e){var n=dn(e.sampleTime)>=dn(t.sampleTime)?e:t;return new Gi(e.startTime,n.toPointValue(),n.sampleTime)},t.prototype.toMetricData=function(t,e,n,r){return{descriptor:t,aggregationTemporality:e,dataPointType:ci.GAUGE,dataPoints:n.map((function(t){var e=Vi(t,2),n=e[0],o=e[1];return{attributes:n,startTime:o.startTime,endTime:r,value:o.toPointValue()}}))}},t}(),Wi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},$i=function(){function t(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=!1),this.startTime=t,this.monotonic=e,this._current=n,this.reset=r}return t.prototype.record=function(t){this.monotonic&&t<0||(this._current+=t)},t.prototype.setStartTime=function(t){this.startTime=t},t.prototype.toPointValue=function(){return this._current},t}(),Xi=function(){function t(t){this.monotonic=t,this.kind=Ai.SUM}return t.prototype.createAccumulation=function(t){return new $i(t,this.monotonic)},t.prototype.merge=function(t,e){var n=t.toPointValue(),r=e.toPointValue();return e.reset?new $i(e.startTime,this.monotonic,r,e.reset):new $i(t.startTime,this.monotonic,n+r)},t.prototype.diff=function(t,e){var n=t.toPointValue(),r=e.toPointValue();return this.monotonic&&n>r?new $i(e.startTime,this.monotonic,r,!0):new $i(e.startTime,this.monotonic,r-n)},t.prototype.toMetricData=function(t,e,n,r){return{descriptor:t,aggregationTemporality:e,dataPointType:ci.SUM,dataPoints:n.map((function(t){var e=Wi(t,2),n=e[0],o=e[1];return{attributes:n,startTime:o.startTime,endTime:r,value:o.toPointValue()}})),isMonotonic:this.monotonic}},t}(),Ki=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yi=function(){function t(){}return t.Drop=function(){return ts},t.Sum=function(){return es},t.LastValue=function(){return ns},t.Histogram=function(){return rs},t.Default=function(){return os},t}(),qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ki(e,t),e.prototype.createAggregator=function(t){return e.DEFAULT_INSTANCE},e.DEFAULT_INSTANCE=new Ui,e}(Yi),zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ki(e,t),e.prototype.createAggregator=function(t){switch(t.type){case fi.COUNTER:case fi.OBSERVABLE_COUNTER:case fi.HISTOGRAM:return e.MONOTONIC_INSTANCE;default:return e.NON_MONOTONIC_INSTANCE}},e.MONOTONIC_INSTANCE=new Xi(!0),e.NON_MONOTONIC_INSTANCE=new Xi(!1),e}(Yi),Ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ki(e,t),e.prototype.createAggregator=function(t){return e.DEFAULT_INSTANCE},e.DEFAULT_INSTANCE=new Fi,e}(Yi),Qi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ki(e,t),e.prototype.createAggregator=function(t){return e.DEFAULT_INSTANCE},e.DEFAULT_INSTANCE=new ji([0,5,10,25,50,75,100,250,500,1e3],!0),e}(Yi);!function(t){function e(e,n){void 0===n&&(n=!0);var r=t.call(this)||this;if(r._recordMinMax=n,void 0===e||0===e.length)throw new Error("HistogramAggregator should be created with boundaries.");var o=(e=(e=e.concat()).sort((function(t,e){return t-e}))).lastIndexOf(-1/0),i=e.indexOf(1/0);return-1===i&&(i=void 0),r._boundaries=e.slice(o+1,i),r}Ki(e,t),e.prototype.createAggregator=function(t){return new ji(this._boundaries,this._recordMinMax)}}(Yi);var Zi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ki(e,t),e.prototype._resolve=function(t){switch(t.type){case fi.COUNTER:case fi.UP_DOWN_COUNTER:case fi.OBSERVABLE_COUNTER:case fi.OBSERVABLE_UP_DOWN_COUNTER:return es;case fi.OBSERVABLE_GAUGE:return ns;case fi.HISTOGRAM:return rs}return le.warn("Unable to recognize instrument type: "+t.type),ts},e.prototype.createAggregator=function(t){return this._resolve(t).createAggregator(t)},e}(Yi),ts=new qi,es=new zi,ns=new Ji,rs=new Qi,os=new Zi;var is=function(t){var e,n;if(null==(n=t).instrumentName&&null==n.instrumentType&&null==n.meterName&&null==n.meterVersion&&null==n.meterSchemaUrl)throw new Error("Cannot create view with no selector arguments supplied");if(null!=t.name&&(null==(null==t?void 0:t.instrumentName)||Ri.hasWildcard(t.instrumentName)))throw new Error("Views with a specified name must be declared with an instrument selector that selects at most one instrument per meter.");null!=t.attributeKeys?this.attributesProcessor=new Li(t.attributeKeys):this.attributesProcessor=Pi.Noop(),this.name=t.name,this.description=t.description,this.aggregation=null!==(e=t.aggregation)&&void 0!==e?e:Yi.Default(),this.instrumentSelector=new xi({name:t.instrumentName,type:t.instrumentType}),this.meterSelector=new ki({name:t.meterName,version:t.meterVersion,schemaUrl:t.meterSchemaUrl})};!function(){function t(){this._registeredViews=[]}t.prototype.addView=function(t){this._registeredViews.push(t)},t.prototype.findViews=function(e,n){var r=this,o=this._registeredViews.filter((function(t){return r._matchInstrument(t.instrumentSelector,e)&&r._matchMeter(t.meterSelector,n)}));return 0===o.length?[t.DEFAULT_VIEW]:o},t.prototype._matchInstrument=function(t,e){return(void 0===t.getType()||e.type===t.getType())&&t.getNameFilter().match(e.name)},t.prototype._matchMeter=function(t,e){return t.getNameFilter().match(e.name)&&(void 0===e.version||t.getVersionFilter().match(e.version))&&(void 0===e.schemaUrl||t.getSchemaUrlFilter().match(e.schemaUrl))},t.DEFAULT_VIEW=new is({instrumentName:"*"})}();var ss=function(){function t(t){this._instrumentDescriptor=t}return t.prototype.getInstrumentDescriptor=function(){return this._instrumentDescriptor},t.prototype.updateDescription=function(t){this._instrumentDescriptor=function(t,e,n){var r,o,i;return{name:t,type:e,description:null!==(r=null==n?void 0:n.description)&&void 0!==r?r:"",unit:null!==(o=null==n?void 0:n.unit)&&void 0!==o?o:"",valueType:null!==(i=null==n?void 0:n.valueType)&&void 0!==i?i:Ho.DOUBLE}}(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:t,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit})},t}(),as=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),cs=function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},us=function(){function t(t){this._hash=t,this._valueMap=new Map,this._keyMap=new Map}return t.prototype.get=function(t,e){return null!=e||(e=this._hash(t)),this._valueMap.get(e)},t.prototype.getOrDefault=function(t,e){var n=this._hash(t);if(this._valueMap.has(n))return this._valueMap.get(n);var r=e();return this._keyMap.has(n)||this._keyMap.set(n,t),this._valueMap.set(n,r),r},t.prototype.set=function(t,e,n){null!=n||(n=this._hash(t)),this._keyMap.has(n)||this._keyMap.set(n,t),this._valueMap.set(n,e)},t.prototype.has=function(t,e){return null!=e||(e=this._hash(t)),this._valueMap.has(e)},t.prototype.keys=function(){var t,e;return cs(this,(function(n){switch(n.label){case 0:t=this._keyMap.entries(),e=t.next(),n.label=1;case 1:return!0===e.done?[3,3]:[4,[e.value[1],e.value[0]]];case 2:return n.sent(),e=t.next(),[3,1];case 3:return[2]}}))},t.prototype.entries=function(){var t,e;return cs(this,(function(n){switch(n.label){case 0:t=this._valueMap.entries(),e=t.next(),n.label=1;case 1:return!0===e.done?[3,3]:[4,[this._keyMap.get(e.value[0]),e.value[1],e.value[0]]];case 2:return n.sent(),e=t.next(),[3,1];case 3:return[2]}}))},Object.defineProperty(t.prototype,"size",{get:function(){return this._valueMap.size},enumerable:!1,configurable:!0}),t}(),ls=function(t){function e(){return t.call(this,pi)||this}return as(e,t),e}(us),ps=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},hs=function(){function t(t){this._aggregator=t,this._activeCollectionStorage=new ls,this._cumulativeMemoStorage=new ls}return t.prototype.record=function(t,e,n,r){var o=this,i=this._activeCollectionStorage.getOrDefault(e,(function(){return o._aggregator.createAccumulation(r)}));null==i||i.record(t)},t.prototype.batchCumulate=function(t,e){var n=this;Array.from(t.entries()).forEach((function(t){var r=ps(t,3),o=r[0],i=r[1],s=r[2],a=n._aggregator.createAccumulation(e);null==a||a.record(i);var c=a;if(n._cumulativeMemoStorage.has(o,s)){var u=n._cumulativeMemoStorage.get(o,s);c=n._aggregator.diff(u,a)}n._cumulativeMemoStorage.set(o,a,s),n._activeCollectionStorage.set(o,c,s)}))},t.prototype.collect=function(){var t=this._activeCollectionStorage;return this._activeCollectionStorage=new ls,t},t}(),_s=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fs=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s},ds=function(){function t(t){this._aggregator=t,this._unreportedAccumulations=new Map,this._reportHistory=new Map}return t.prototype.buildMetrics=function(e,n,r,o,i){this._stashAccumulations(n,o);var s,a,c=this._getMergedUnreportedAccumulations(e),u=c;if(this._reportHistory.has(e)){var l=this._reportHistory.get(e),p=l.collectionTime;u=(s=l.aggregationTemporality)===ai.CUMULATIVE?t.merge(l.accumulations,c,this._aggregator):t.calibrateStartTime(l.accumulations,c,p)}else s=e.selectAggregationTemporality(r.type);return this._reportHistory.set(e,{accumulations:u,collectionTime:i,aggregationTemporality:s}),this._aggregator.toMetricData(r,s,(a=u,Array.from(a.entries())),i)},t.prototype._stashAccumulations=function(t,e){var n=this;t.forEach((function(t){var r=n._unreportedAccumulations.get(t);void 0===r&&(r=[],n._unreportedAccumulations.set(t,r)),r.push(e)}))},t.prototype._getMergedUnreportedAccumulations=function(e){var n,r,o=new ls,i=this._unreportedAccumulations.get(e);if(this._unreportedAccumulations.set(e,[]),void 0===i)return o;try{for(var s=_s(i),a=s.next();!a.done;a=s.next()){var c=a.value;o=t.merge(o,c,this._aggregator)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o},t.merge=function(t,e,n){for(var r=t,o=e.entries(),i=o.next();!0!==i.done;){var s=fs(i.value,3),a=s[0],c=s[1],u=s[2];if(t.has(a,u)){var l=t.get(a,u),p=n.merge(l,c);r.set(a,p,u)}else r.set(a,c,u);i=o.next()}return r},t.calibrateStartTime=function(t,e,n){var r,o;try{for(var i=_s(t.keys()),s=i.next();!s.done;s=i.next()){var a=fs(s.value,2),c=a[0],u=a[1],l=e.get(c,u);null==l||l.setStartTime(n)}}catch(t){r={error:t}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return e},t}();var Es=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gs=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s};!function(t){function e(e,n,r){var o=t.call(this,e)||this;return o._attributesProcessor=r,o._deltaMetricStorage=new hs(n),o._temporalMetricStorage=new ds(n),o}Es(e,t),e.prototype.record=function(t,e){var n=this,r=new ls;Array.from(t.entries()).forEach((function(t){var e=gs(t,2),o=e[0],i=e[1];r.set(n._attributesProcessor.process(o),i)})),this._deltaMetricStorage.batchCumulate(r,e)},e.prototype.collect=function(t,e,n){var r=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(t,e,this._instrumentDescriptor,r,n)}}(ss);var ys=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){function e(e,n,r){var o=t.call(this,e)||this;return o._attributesProcessor=r,o._deltaMetricStorage=new hs(n),o._temporalMetricStorage=new ds(n),o}ys(e,t),e.prototype.record=function(t,e,n,r){e=this._attributesProcessor.process(e,n),this._deltaMetricStorage.record(t,e,n,r)},e.prototype.collect=function(t,e,n){var r=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(t,e,this._instrumentDescriptor,r,n)}}(ss);var ms=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ss="v1/traces",vs=function(t){function e(e){void 0===e&&(e={});var n=t.call(this,e)||this;return n._headers=Object.assign(n._headers,we(ze().OTEL_EXPORTER_OTLP_TRACES_HEADERS)),n}return ms(e,t),e.prototype.convert=function(t){return function(t,e){return{resourceSpans:Bo(t,e)}}(t,!0)},e.prototype.getDefaultUrl=function(t){return"string"==typeof t.url?t.url:ze().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT.length>0?(e=ze().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT,n=Ss,e.includes(n)||e.endsWith("/")||(e+="/"),e):ze().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?function(t,e){return t.endsWith("/")||(t+="/"),t+e}(ze().OTEL_EXPORTER_OTLP_ENDPOINT,Ss):"http://localhost:4318/v1/traces";var e,n},e}(No),Ts=Object.freeze({__proto__:null,OTLPTraceExporter:vs});const{Resource:bs}=Lr,{SemanticResourceAttributes:Os}=de,{WebTracerProvider:ws}=go,{BatchSpanProcessor:As}=so,{OTLPTraceExporter:Cs}=Ts,{AlwaysOnSampler:Rs,W3CTraceContextPropagator:Ns}=ar,Is=pe,Ps=function(){const t=bs.default().merge(new bs({[Os.SERVICE_NAME]:"com.dynatrace.samplechat",[Os.SERVICE_VERSION]:"0.1.0"})),e=new ws({resource:t,sampler:new Rs}),n=new Cs({url:"http://localhost:4317/v1/traces",headers:{}}),r=new As(n);e.addSpanProcessor(r),e.register({propagator:new Ns});return pe.trace.getTracer("com.dynatrace.samplechat")}(),Ms=3,Ls=4;document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("message"),e=prompt("Enter your name:","");t.focus();var n=(new z.HubConnectionBuilder).withUrl("/chat").build();n.on("broadcastMessage",(function(t,e,n){const r=Is.propagation.extract(Is.context.active(),JSON.parse(n));Ps.startActiveSpan("processBroadcastMessage",{kind:Ls},r,(n=>{var r=t,o=e,i=document.createElement("li");i.innerHTML="<strong>"+r+"</strong>:&nbsp;&nbsp;"+o,document.getElementById("discussion").appendChild(i),n.end()}))})),n.start().then((function(){console.log("connection started"),document.getElementById("sendMessage").addEventListener("click",(function(r){Ps.startActiveSpan("sendMessage",{kind:Ms,root:!0},(o=>{const i={};Is.propagation.inject(Is.context.active(),i);const s=JSON.stringify(i),a=n.invoke("send",e,t.value,s);t.value="",t.focus(),r.preventDefault(),a.finally((t=>o.end()))}))}))})).catch((t=>{console.error(t.message)}))}))}();
